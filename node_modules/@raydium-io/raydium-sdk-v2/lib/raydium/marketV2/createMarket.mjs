var Rn=Object.defineProperty,Mn=Object.defineProperties;var In=Object.getOwnPropertyDescriptors;var Ie=Object.getOwnPropertySymbols;var vt=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable;var Kt=(e,t,n)=>t in e?Rn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_=(e,t)=>{for(var n in t||(t={}))vt.call(t,n)&&Kt(e,n,t[n]);if(Ie)for(var n of Ie(t))_t.call(t,n)&&Kt(e,n,t[n]);return e},ne=(e,t)=>Mn(e,In(t));var Ke=(e,t)=>{var n={};for(var r in e)vt.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Ie)for(var r of Ie(e))t.indexOf(r)<0&&_t.call(e,r)&&(n[r]=e[r]);return n};import{PublicKey as Mt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Dn}from"@solana/spl-token";import Re from"bn.js";import{get as Ft,set as Kn}from"lodash";import Vt from"dayjs";import vn from"dayjs/plugin/utc";Vt.extend(vn);var ot=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Vt().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Ot={},_n={};function V(e){let t=Ft(Ot,e);if(!t){let n=Ft(_n,e);t=new ot({name:e,logLevel:n}),Kn(Ot,e,t)}return t}import{PublicKey as Ne,sendAndConfirmTransaction as xt,Transaction as ke,TransactionMessage as Ce,VersionedTransaction as Ee}from"@solana/web3.js";import Zr from"axios";var G={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw"};import{PublicKey as Li,ComputeBudgetProgram as qt,Transaction as Ut,TransactionMessage as Fn,Keypair as Gt,VersionedTransaction as zt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as On}from"@solana/spl-token";var Wt=V("Raydium_txUtil"),Ht=1644;function ve(e){let t=[],n=[];return e.microLamports&&(t.push(qt.setComputeUnitPrice({microLamports:e.microLamports})),n.push(G.SetComputeUnitPrice)),e.units&&(t.push(qt.setComputeUnitLimit({units:e.units})),n.push(G.SetComputeUnitLimit)),{instructions:t,instructionTypes:n}}async function me(e){var t,n;try{return((n=await((t=e.getLatestBlockhash)==null?void 0:t.call(e)))==null?void 0:n.blockhash)||(await e.getRecentBlockhash()).blockhash}catch{return(await e.getRecentBlockhash()).blockhash}}function Vn(e,t){e.length<1&&Wt.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&Wt.logWithError(`no signers provided:, ${t.toString()}`);let n=new Ut;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<Ht}catch{return!1}}function Te({instructions:e,payer:t,signers:n}){return Vn(e,[t,...n])}function Pe({instructions:e,payer:t,lookupTableAddressAccount:n,recentBlockhash:r=Gt.generate().publicKey.toString()}){let o=new Fn({payerKey:t,recentBlockhash:r,instructions:e}).compileToV0Message(Object.values(n!=null?n:{}));try{return Buffer.from(new zt(o).serialize()).toString("base64").length<Ht}catch{return!1}}var qn=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);function fe(e){let t=[];return e.forEach(n=>{n instanceof Ut&&(n.recentBlockhash||(n.recentBlockhash=On.toBase58()),n.feePayer||(n.feePayer=Gt.generate().publicKey));let r=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof zt&&(r=qn(r));let i=r.toString("base64");t.push(i)}),console.log("simulate tx string:",t),t}import{PublicKey as yn,AddressLookupTableAccount as Qe}from"@solana/web3.js";import{PublicKey as Qr}from"@solana/web3.js";import{getTransferFeeConfig as vu,unpackMint as _u}from"@solana/spl-token";import{PublicKey as Ms}from"@solana/web3.js";import Ks from"bn.js";import Yr from"big.js";import ds from"bn.js";import H from"bn.js";var ge=9e15,se=1e9,st="0123456789abcdef",Fe="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Oe="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ut={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-ge,maxE:ge,crypto:!1},Zt,ee,P=!0,qe="[DecimalError] ",oe=qe+"Invalid argument: ",Jt=qe+"Precision limit exceeded",Xt=qe+"crypto unavailable",$t="[object Decimal]",q=Math.floor,K=Math.pow,Wn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Un=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Gn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,en=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,J=1e7,T=7,zn=9007199254740991,Hn=Fe.length-1,at=Oe.length-1,g={toStringTag:$t};g.absoluteValue=g.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),x(e)};g.ceil=function(){return x(new this.constructor(this),this.e+1,2)};g.clampedTo=g.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(oe+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};g.comparedTo=g.cmp=function(e){var t,n,r,i,o=this,s=o.d,u=(e=new o.constructor(e)).d,c=o.s,a=e.s;if(!s||!u)return!c||!a?NaN:c!==a?c:s===u?0:!s^c<0?1:-1;if(!s[0]||!u[0])return s[0]?c:u[0]?-a:0;if(c!==a)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=s.length,i=u.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==u[t])return s[t]>u[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};g.cosine=g.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+T,r.rounding=1,n=jn(r,sn(r,n)),r.precision=e,r.rounding=t,x(ee==2||ee==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};g.cubeRoot=g.cbrt=function(){var e,t,n,r,i,o,s,u,c,a,f=this,l=f.constructor;if(!f.isFinite()||f.isZero())return new l(f);for(P=!1,o=f.s*K(f.s*f,1/3),!o||Math.abs(o)==1/0?(n=F(f.d),e=f.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=K(n,1/3),e=q((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new l(n),r.s=f.s):r=new l(o.toString()),s=(e=l.precision)+3;;)if(u=r,c=u.times(u).times(u),a=c.plus(f),r=C(a.plus(f).times(u),a.plus(c),s+2,1),F(u.d).slice(0,s)===(n=F(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(x(u,e+1,0),u.times(u).times(u).eq(f))){r=u;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(x(r,e+1,1),t=!r.times(r).times(r).eq(f));break}return P=!0,x(r,e,l.rounding,t)};g.decimalPlaces=g.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-q(this.e/T))*T,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};g.dividedBy=g.div=function(e){return C(this,new this.constructor(e))};g.dividedToIntegerBy=g.divToInt=function(e){var t=this,n=t.constructor;return x(C(t,new n(e),0,1,1),n.precision,n.rounding)};g.equals=g.eq=function(e){return this.cmp(e)===0};g.floor=function(){return x(new this.constructor(this),this.e+1,3)};g.greaterThan=g.gt=function(e){return this.cmp(e)>0};g.greaterThanOrEqualTo=g.gte=function(e){var t=this.cmp(e);return t==1||t===0};g.hyperbolicCosine=g.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,u=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return u;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/Ue(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=he(s,1,o.times(t),new s(1),!0);for(var c,a=e,f=new s(8);a--;)c=o.times(o),o=u.minus(c.times(f.minus(c.times(f))));return x(o,s.precision=n,s.rounding=r,!0)};g.hyperbolicSine=g.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=he(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/Ue(5,e)),i=he(o,2,i,i,!0);for(var s,u=new o(5),c=new o(16),a=new o(20);e--;)s=i.times(i),i=i.times(u.plus(s.times(c.times(s).plus(a))))}return o.precision=t,o.rounding=n,x(i,t,n,!0)};g.hyperbolicTangent=g.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,C(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};g.inverseCosine=g.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?Z(n,i,o):new n(0):new n(NaN):t.isZero()?Z(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=Z(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};g.inverseHyperbolicCosine=g.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,P=!1,n=n.times(n).minus(1).sqrt().plus(n),P=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};g.inverseHyperbolicSine=g.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,P=!1,n=n.times(n).plus(1).sqrt().plus(n),P=!0,r.precision=e,r.rounding=t,n.ln())};g.inverseHyperbolicTangent=g.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?x(new o(i),e,t,!0):(o.precision=n=r-i.e,i=C(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};g.inverseSine=g.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=Z(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};g.inverseTangent=g.atan=function(){var e,t,n,r,i,o,s,u,c,a=this,f=a.constructor,l=f.precision,p=f.rounding;if(a.isFinite()){if(a.isZero())return new f(a);if(a.abs().eq(1)&&l+4<=at)return s=Z(f,l+4,p).times(.25),s.s=a.s,s}else{if(!a.s)return new f(NaN);if(l+4<=at)return s=Z(f,l+4,p).times(.5),s.s=a.s,s}for(f.precision=u=l+10,f.rounding=1,n=Math.min(28,u/T+2|0),e=n;e;--e)a=a.div(a.times(a).plus(1).sqrt().plus(1));for(P=!1,t=Math.ceil(u/T),r=1,c=a.times(a),s=new f(a),i=a;e!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),P=!0,x(s,f.precision=l,f.rounding=p,!0)};g.isFinite=function(){return!!this.d};g.isInteger=g.isInt=function(){return!!this.d&&q(this.e/T)>this.d.length-2};g.isNaN=function(){return!this.s};g.isNegative=g.isNeg=function(){return this.s<0};g.isPositive=g.isPos=function(){return this.s>0};g.isZero=function(){return!!this.d&&this.d[0]===0};g.lessThan=g.lt=function(e){return this.cmp(e)<0};g.lessThanOrEqualTo=g.lte=function(e){return this.cmp(e)<1};g.logarithm=g.log=function(e){var t,n,r,i,o,s,u,c,a=this,f=a.constructor,l=f.precision,p=f.rounding,m=5;if(e==null)e=new f(10),t=!0;else{if(e=new f(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new f(NaN);t=e.eq(10)}if(n=a.d,a.s<0||!n||!n[0]||a.eq(1))return new f(n&&!n[0]?-1/0:a.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(P=!1,u=l+m,s=ie(a,u),r=t?Ve(f,u+10):ie(e,u),c=C(s,r,u,1),Ae(c.d,i=l,p))do if(u+=10,s=ie(a,u),r=t?Ve(f,u+10):ie(e,u),c=C(s,r,u,1),!o){+F(c.d).slice(i+1,i+15)+1==1e14&&(c=x(c,l+1,0));break}while(Ae(c.d,i+=10,p));return P=!0,x(c,l,p)};g.minus=g.sub=function(e){var t,n,r,i,o,s,u,c,a,f,l,p,m=this,h=m.constructor;if(e=new h(e),!m.d||!e.d)return!m.s||!e.s?e=new h(NaN):m.d?e.s=-e.s:e=new h(e.d||m.s!==e.s?m:NaN),e;if(m.s!=e.s)return e.s=-e.s,m.plus(e);if(a=m.d,p=e.d,u=h.precision,c=h.rounding,!a[0]||!p[0]){if(p[0])e.s=-e.s;else if(a[0])e=new h(m);else return new h(c===3?-0:0);return P?x(e,u,c):e}if(n=q(e.e/T),f=q(m.e/T),a=a.slice(),o=f-n,o){for(l=o<0,l?(t=a,o=-o,s=p.length):(t=p,n=f,s=a.length),r=Math.max(Math.ceil(u/T),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=a.length,s=p.length,l=r<s,l&&(s=r),r=0;r<s;r++)if(a[r]!=p[r]){l=a[r]<p[r];break}o=0}for(l&&(t=a,a=p,p=t,e.s=-e.s),s=a.length,r=p.length-s;r>0;--r)a[s++]=0;for(r=p.length;r>o;){if(a[--r]<p[r]){for(i=r;i&&a[--i]===0;)a[i]=J-1;--a[i],a[r]+=J}a[r]-=p[r]}for(;a[--s]===0;)a.pop();for(;a[0]===0;a.shift())--n;return a[0]?(e.d=a,e.e=We(a,n),P?x(e,u,c):e):new h(c===3?-0:0)};g.modulo=g.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?x(new r(n),r.precision,r.rounding):(P=!1,r.modulo==9?(t=C(n,e.abs(),0,3,1),t.s*=e.s):t=C(n,e,0,r.modulo,1),t=t.times(e),P=!0,n.minus(t))};g.naturalExponential=g.exp=function(){return ct(this)};g.naturalLogarithm=g.ln=function(){return ie(this)};g.negated=g.neg=function(){var e=new this.constructor(this);return e.s=-e.s,x(e)};g.plus=g.add=function(e){var t,n,r,i,o,s,u,c,a,f,l=this,p=l.constructor;if(e=new p(e),!l.d||!e.d)return!l.s||!e.s?e=new p(NaN):l.d||(e=new p(e.d||l.s===e.s?l:NaN)),e;if(l.s!=e.s)return e.s=-e.s,l.minus(e);if(a=l.d,f=e.d,u=p.precision,c=p.rounding,!a[0]||!f[0])return f[0]||(e=new p(l)),P?x(e,u,c):e;if(o=q(l.e/T),r=q(e.e/T),a=a.slice(),i=o-r,i){for(i<0?(n=a,i=-i,s=f.length):(n=f,r=o,s=a.length),o=Math.ceil(u/T),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=a.length,i=f.length,s-i<0&&(i=s,n=f,f=a,a=n),t=0;i;)t=(a[--i]=a[i]+f[i]+t)/J|0,a[i]%=J;for(t&&(a.unshift(t),++r),s=a.length;a[--s]==0;)a.pop();return e.d=a,e.e=We(a,r),P?x(e,u,c):e};g.precision=g.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(oe+e);return n.d?(t=tn(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};g.round=function(){var e=this,t=e.constructor;return x(new t(e),e.e+1,t.rounding)};g.sine=g.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+T,r.rounding=1,n=Qn(r,sn(r,n)),r.precision=e,r.rounding=t,x(ee>2?n.neg():n,e,t,!0)):new r(NaN)};g.squareRoot=g.sqrt=function(){var e,t,n,r,i,o,s=this,u=s.d,c=s.e,a=s.s,f=s.constructor;if(a!==1||!u||!u[0])return new f(!a||a<0&&(!u||u[0])?NaN:u?s:1/0);for(P=!1,a=Math.sqrt(+s),a==0||a==1/0?(t=F(u),(t.length+c)%2==0&&(t+="0"),a=Math.sqrt(t),c=q((c+1)/2)-(c<0||c%2),a==1/0?t="5e"+c:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new f(t)):r=new f(a.toString()),n=(c=f.precision)+3;;)if(o=r,r=o.plus(C(s,o,n+2,1)).times(.5),F(o.d).slice(0,n)===(t=F(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(x(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(x(r,c+1,1),e=!r.times(r).eq(s));break}return P=!0,x(r,c,f.rounding,e)};g.tangent=g.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=C(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,x(ee==2||ee==4?n.neg():n,e,t,!0)):new r(NaN)};g.times=g.mul=function(e){var t,n,r,i,o,s,u,c,a,f=this,l=f.constructor,p=f.d,m=(e=new l(e)).d;if(e.s*=f.s,!p||!p[0]||!m||!m[0])return new l(!e.s||p&&!p[0]&&!m||m&&!m[0]&&!p?NaN:!p||!m?e.s/0:e.s*0);for(n=q(f.e/T)+q(e.e/T),c=p.length,a=m.length,c<a&&(o=p,p=m,m=o,s=c,c=a,a=s),o=[],s=c+a,r=s;r--;)o.push(0);for(r=a;--r>=0;){for(t=0,i=c+r;i>r;)u=o[i]+m[r]*p[i-r-1]+t,o[i--]=u%J|0,t=u/J|0;o[i]=(o[i]+t)%J|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=We(o,n),P?x(e,l.precision,l.rounding):e};g.toBinary=function(e,t){return ft(this,2,e,t)};g.toDecimalPlaces=g.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(z(e,0,se),t===void 0?t=r.rounding:z(t,0,8),x(n,e+n.e+1,t))};g.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=$(r,!0):(z(e,0,se),t===void 0?t=i.rounding:z(t,0,8),r=x(new i(r),e+1,t),n=$(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};g.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=$(i):(z(e,0,se),t===void 0?t=o.rounding:z(t,0,8),r=x(new o(i),e+i.e+1,t),n=$(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};g.toFraction=function(e){var t,n,r,i,o,s,u,c,a,f,l,p,m=this,h=m.d,d=m.constructor;if(!h)return new d(m);if(a=n=new d(1),r=c=new d(0),t=new d(r),o=t.e=tn(h)-m.e-1,s=o%T,t.d[0]=K(10,s<0?T+s:s),e==null)e=o>0?t:a;else{if(u=new d(e),!u.isInt()||u.lt(a))throw Error(oe+u);e=u.gt(t)?o>0?t:a:u}for(P=!1,u=new d(F(h)),f=d.precision,d.precision=o=h.length*T*2;l=C(u,t,0,1,1),i=n.plus(l.times(r)),i.cmp(e)!=1;)n=r,r=i,i=a,a=c.plus(l.times(i)),c=i,i=t,t=u.minus(l.times(i)),u=i;return i=C(e.minus(n),r,0,1,1),c=c.plus(i.times(a)),n=n.plus(i.times(r)),c.s=a.s=m.s,p=C(a,r,o,1).minus(m).abs().cmp(C(c,n,o,1).minus(m).abs())<1?[a,r]:[c,n],d.precision=f,P=!0,p};g.toHexadecimal=g.toHex=function(e,t){return ft(this,16,e,t)};g.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:z(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(P=!1,n=C(n,e,0,t,1).times(e),P=!0,x(n)):(e.s=n.s,n=e),n};g.toNumber=function(){return+this};g.toOctal=function(e,t){return ft(this,8,e,t)};g.toPower=g.pow=function(e){var t,n,r,i,o,s,u=this,c=u.constructor,a=+(e=new c(e));if(!u.d||!e.d||!u.d[0]||!e.d[0])return new c(K(+u,a));if(u=new c(u),u.eq(1))return u;if(r=c.precision,o=c.rounding,e.eq(1))return x(u,r,o);if(t=q(e.e/T),t>=e.d.length-1&&(n=a<0?-a:a)<=zn)return i=nn(c,u,n,r),e.s<0?new c(1).div(i):x(i,r,o);if(s=u.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),u.e==0&&u.d[0]==1&&u.d.length==1)return u.s=s,u}return n=K(+u,a),t=n==0||!isFinite(n)?q(a*(Math.log("0."+F(u.d))/Math.LN10+u.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(P=!1,c.rounding=u.s=1,n=Math.min(12,(t+"").length),i=ct(e.times(ie(u,r+n)),r),i.d&&(i=x(i,r+5,1),Ae(i.d,r,o)&&(t=r+10,i=x(ct(e.times(ie(u,t+n)),t),t+5,1),+F(i.d).slice(r+1,r+15)+1==1e14&&(i=x(i,r+1,0)))),i.s=s,P=!0,c.rounding=o,x(i,r,o))};g.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=$(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(z(e,1,se),t===void 0?t=i.rounding:z(t,0,8),r=x(new i(r),e,t),n=$(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};g.toSignificantDigits=g.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(z(e,1,se),t===void 0?t=r.rounding:z(t,0,8)),x(new r(n),e,t)};g.toString=function(){var e=this,t=e.constructor,n=$(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};g.truncated=g.trunc=function(){return x(new this.constructor(this),this.e+1,1)};g.valueOf=g.toJSON=function(){var e=this,t=e.constructor,n=$(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function F(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=T-r.length,n&&(o+=re(n)),o+=r;s=e[t],r=s+"",n=T-r.length,n&&(o+=re(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function z(e,t,n){if(e!==~~e||e<t||e>n)throw Error(oe+e)}function Ae(e,t,n,r){var i,o,s,u;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=T,i=0):(i=Math.ceil((t+1)/T),t%=T),o=K(10,T-t),u=e[i]%o|0,r==null?t<3?(t==0?u=u/100|0:t==1&&(u=u/10|0),s=n<4&&u==99999||n>3&&u==49999||u==5e4||u==0):s=(n<4&&u+1==o||n>3&&u+1==o/2)&&(e[i+1]/o/100|0)==K(10,t-2)-1||(u==o/2||u==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?u=u/1e3|0:t==1?u=u/100|0:t==2&&(u=u/10|0),s=(r||n<4)&&u==9999||!r&&n>3&&u==4999):s=((r||n<4)&&u+1==o||!r&&n>3&&u+1==o/2)&&(e[i+1]/o/1e3|0)==K(10,t-3)-1,s}function _e(e,t,n){for(var r,i=[0],o,s=0,u=e.length;s<u;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=st.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function jn(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/Ue(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=he(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var C=function(){function e(r,i,o){var s,u=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+u,r[c]=s%o|0,u=s/o|0;return u&&r.unshift(u),r}function t(r,i,o,s){var u,c;if(o!=s)c=o>s?1:-1;else for(u=c=0;u<o;u++)if(r[u]!=i[u]){c=r[u]>i[u]?1:-1;break}return c}function n(r,i,o,s){for(var u=0;o--;)r[o]-=u,u=r[o]<i[o]?1:0,r[o]=u*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,u,c){var a,f,l,p,m,h,d,w,b,B,y,N,A,k,v,Y,Q,U,M,te,Me=r.constructor,it=r.s==i.s?1:-1,O=r.d,E=i.d;if(!O||!O[0]||!E||!E[0])return new Me(!r.s||!i.s||(O?E&&O[0]==E[0]:!E)?NaN:O&&O[0]==0||!E?it*0:it/0);for(c?(m=1,f=r.e-i.e):(c=J,m=T,f=q(r.e/m)-q(i.e/m)),M=E.length,Q=O.length,b=new Me(it),B=b.d=[],l=0;E[l]==(O[l]||0);l++);if(E[l]>(O[l]||0)&&f--,o==null?(k=o=Me.precision,s=Me.rounding):u?k=o+(r.e-i.e)+1:k=o,k<0)B.push(1),h=!0;else{if(k=k/m+2|0,l=0,M==1){for(p=0,E=E[0],k++;(l<Q||p)&&k--;l++)v=p*c+(O[l]||0),B[l]=v/E|0,p=v%E|0;h=p||l<Q}else{for(p=c/(E[0]+1)|0,p>1&&(E=e(E,p,c),O=e(O,p,c),M=E.length,Q=O.length),Y=M,y=O.slice(0,M),N=y.length;N<M;)y[N++]=0;te=E.slice(),te.unshift(0),U=E[0],E[1]>=c/2&&++U;do p=0,a=t(E,y,M,N),a<0?(A=y[0],M!=N&&(A=A*c+(y[1]||0)),p=A/U|0,p>1?(p>=c&&(p=c-1),d=e(E,p,c),w=d.length,N=y.length,a=t(d,y,w,N),a==1&&(p--,n(d,M<w?te:E,w,c))):(p==0&&(a=p=1),d=E.slice()),w=d.length,w<N&&d.unshift(0),n(y,d,N,c),a==-1&&(N=y.length,a=t(E,y,M,N),a<1&&(p++,n(y,M<N?te:E,N,c))),N=y.length):a===0&&(p++,y=[0]),B[l++]=p,a&&y[0]?y[N++]=O[Y]||0:(y=[O[Y]],N=1);while((Y++<Q||y[0]!==void 0)&&k--);h=y[0]!==void 0}B[0]||B.shift()}if(m==1)b.e=f,Zt=h;else{for(l=1,p=B[0];p>=10;p/=10)l++;b.e=l+f*m-1,x(b,u?o+b.e+1:o,s,h)}return b}}();function x(e,t,n,r){var i,o,s,u,c,a,f,l,p,m=e.constructor;e:if(t!=null){if(l=e.d,!l)return e;for(i=1,u=l[0];u>=10;u/=10)i++;if(o=t-i,o<0)o+=T,s=t,f=l[p=0],c=f/K(10,i-s-1)%10|0;else if(p=Math.ceil((o+1)/T),u=l.length,p>=u)if(r){for(;u++<=p;)l.push(0);f=c=0,i=1,o%=T,s=o-T+1}else break e;else{for(f=u=l[p],i=1;u>=10;u/=10)i++;o%=T,s=o-T+i,c=s<0?0:f/K(10,i-s-1)%10|0}if(r=r||t<0||l[p+1]!==void 0||(s<0?f:f%K(10,i-s-1)),a=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?f/K(10,i-s):0:l[p-1])%10&1||n==(e.s<0?8:7)),t<1||!l[0])return l.length=0,a?(t-=e.e+1,l[0]=K(10,(T-t%T)%T),e.e=-t||0):l[0]=e.e=0,e;if(o==0?(l.length=p,u=1,p--):(l.length=p+1,u=K(10,T-o),l[p]=s>0?(f/K(10,i-s)%K(10,s)|0)*u:0),a)for(;;)if(p==0){for(o=1,s=l[0];s>=10;s/=10)o++;for(s=l[0]+=u,u=1;s>=10;s/=10)u++;o!=u&&(e.e++,l[0]==J&&(l[0]=1));break}else{if(l[p]+=u,l[p]!=J)break;l[p--]=0,u=1}for(o=l.length;l[--o]===0;)l.pop()}return P&&(e.e>m.maxE?(e.d=null,e.e=NaN):e.e<m.minE&&(e.e=0,e.d=[0])),e}function $(e,t,n){if(!e.isFinite())return on(e);var r,i=e.e,o=F(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+re(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+re(-i-1)+o,n&&(r=n-s)>0&&(o+=re(r))):i>=s?(o+=re(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+re(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=re(r))),o}function We(e,t){var n=e[0];for(t*=T;n>=10;n/=10)t++;return t}function Ve(e,t,n){if(t>Hn)throw P=!0,n&&(e.precision=n),Error(Jt);return x(new e(Fe),t,1,!0)}function Z(e,t,n){if(t>at)throw Error(Jt);return x(new e(Oe),t,n,!0)}function tn(e){var t=e.length-1,n=t*T+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function re(e){for(var t="";e--;)t+="0";return t}function nn(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/T+4);for(P=!1;;){if(n%2&&(o=o.times(t),Yt(o.d,s)&&(i=!0)),n=q(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),Yt(t.d,s)}return P=!0,o}function jt(e){return e.d[e.d.length-1]&1}function rn(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function ct(e,t){var n,r,i,o,s,u,c,a=0,f=0,l=0,p=e.constructor,m=p.rounding,h=p.precision;if(!e.d||!e.d[0]||e.e>17)return new p(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(P=!1,c=h):c=t,u=new p(.03125);e.e>-2;)e=e.times(u),l+=5;for(r=Math.log(K(2,l))/Math.LN10*2+5|0,c+=r,n=o=s=new p(1),p.precision=c;;){if(o=x(o.times(e),c,1),n=n.times(++f),u=s.plus(C(o,n,c,1)),F(u.d).slice(0,c)===F(s.d).slice(0,c)){for(i=l;i--;)s=x(s.times(s),c,1);if(t==null)if(a<3&&Ae(s.d,c-r,m,a))p.precision=c+=10,n=o=u=new p(1),f=0,a++;else return x(s,p.precision=h,m,P=!0);else return p.precision=h,s}s=u}}function ie(e,t){var n,r,i,o,s,u,c,a,f,l,p,m=1,h=10,d=e,w=d.d,b=d.constructor,B=b.rounding,y=b.precision;if(d.s<0||!w||!w[0]||!d.e&&w[0]==1&&w.length==1)return new b(w&&!w[0]?-1/0:d.s!=1?NaN:w?0:d);if(t==null?(P=!1,f=y):f=t,b.precision=f+=h,n=F(w),r=n.charAt(0),Math.abs(o=d.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)d=d.times(e),n=F(d.d),r=n.charAt(0),m++;o=d.e,r>1?(d=new b("0."+n),o++):d=new b(r+"."+n.slice(1))}else return a=Ve(b,f+2,y).times(o+""),d=ie(new b(r+"."+n.slice(1)),f-h).plus(a),b.precision=y,t==null?x(d,y,B,P=!0):d;for(l=d,c=s=d=C(d.minus(1),d.plus(1),f,1),p=x(d.times(d),f,1),i=3;;){if(s=x(s.times(p),f,1),a=c.plus(C(s,new b(i),f,1)),F(a.d).slice(0,f)===F(c.d).slice(0,f))if(c=c.times(2),o!==0&&(c=c.plus(Ve(b,f+2,y).times(o+""))),c=C(c,new b(m),f,1),t==null)if(Ae(c.d,f-h,B,u))b.precision=f+=h,a=s=d=C(l.minus(1),l.plus(1),f,1),p=x(d.times(d),f,1),i=u=1;else return x(c,b.precision=y,B,P=!0);else return b.precision=y,c;c=a,i+=2}}function on(e){return String(e.s*e.s/0)}function lt(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%T,n<0&&(r+=T),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=T;r<i;)e.d.push(+t.slice(r,r+=T));t=t.slice(r),r=T-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),P&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Yn(e,t){var n,r,i,o,s,u,c,a,f;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),en.test(t))return lt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Un.test(t))n=16,t=t.toLowerCase();else if(Wn.test(t))n=2;else if(Gn.test(t))n=8;else throw Error(oe+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),u=t.length,o=u-o,i=nn(r,new r(n),o,o*2)),a=_e(t,n,J),f=a.length-1,o=f;a[o]===0;--o)a.pop();return o<0?new r(e.s*0):(e.e=We(a,f),e.d=a,P=!1,s&&(e=C(e,i,u*4)),c&&(e=e.times(Math.abs(c)<54?K(2,c):Ge.pow(2,c))),P=!0,e)}function Qn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:he(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Ue(5,n)),t=he(e,2,t,t);for(var i,o=new e(5),s=new e(16),u=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(u))));return t}function he(e,t,n,r,i){var o,s,u,c,a=1,f=e.precision,l=Math.ceil(f/T);for(P=!1,c=n.times(n),u=new e(r);;){if(s=C(u.times(c),new e(t++*t++),f,1),u=i?r.plus(s):r.minus(s),r=C(s.times(c),new e(t++*t++),f,1),s=u.plus(r),s.d[l]!==void 0){for(o=l;s.d[o]===u.d[o]&&o--;);if(o==-1)break}o=u,u=r,r=s,s=o,a++}return P=!0,s.d.length=l+1,s}function Ue(e,t){for(var n=e;--t;)n*=e;return n}function sn(e,t){var n,r=t.s<0,i=Z(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return ee=r?4:1,t;if(n=t.divToInt(i),n.isZero())ee=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return ee=jt(n)?r?2:3:r?4:1,t;ee=jt(n)?r?1:4:r?3:2}return t.minus(i).abs()}function ft(e,t,n,r){var i,o,s,u,c,a,f,l,p,m=e.constructor,h=n!==void 0;if(h?(z(n,1,se),r===void 0?r=m.rounding:z(r,0,8)):(n=m.precision,r=m.rounding),!e.isFinite())f=on(e);else{for(f=$(e),s=f.indexOf("."),h?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(f=f.replace(".",""),p=new m(1),p.e=f.length-s,p.d=_e($(p),10,i),p.e=p.d.length),l=_e(f,10,i),o=c=l.length;l[--c]==0;)l.pop();if(!l[0])f=h?"0p+0":"0";else{if(s<0?o--:(e=new m(e),e.d=l,e.e=o,e=C(e,p,n,r,0,i),l=e.d,o=e.e,a=Zt),s=l[n],u=i/2,a=a||l[n+1]!==void 0,a=r<4?(s!==void 0||a)&&(r===0||r===(e.s<0?3:2)):s>u||s===u&&(r===4||a||r===6&&l[n-1]&1||r===(e.s<0?8:7)),l.length=n,a)for(;++l[--n]>i-1;)l[n]=0,n||(++o,l.unshift(1));for(c=l.length;!l[c-1];--c);for(s=0,f="";s<c;s++)f+=st.charAt(l[s]);if(h){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)f+="0";for(l=_e(f,i,t),c=l.length;!l[c-1];--c);for(s=1,f="1.";s<c;s++)f+=st.charAt(l[s])}else f=f.charAt(0)+"."+f.slice(1);f=f+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)f="0"+f;f="0."+f}else if(++o>c)for(o-=c;o--;)f+="0";else o<c&&(f=f.slice(0,o)+"."+f.slice(o))}f=(t==16?"0x":t==2?"0b":t==8?"0o":"")+f}return e.s<0?"-"+f:f}function Yt(e,t){if(e.length>t)return e.length=t,!0}function Zn(e){return new this(e).abs()}function Jn(e){return new this(e).acos()}function Xn(e){return new this(e).acosh()}function $n(e,t){return new this(e).plus(t)}function er(e){return new this(e).asin()}function tr(e){return new this(e).asinh()}function nr(e){return new this(e).atan()}function rr(e){return new this(e).atanh()}function ir(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=Z(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?Z(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=Z(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(C(e,t,o,1)),t=Z(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(C(e,t,o,1)),n}function or(e){return new this(e).cbrt()}function sr(e){return x(e=new this(e),e.e+1,2)}function ur(e,t,n){return new this(e).clamp(t,n)}function ar(e){if(!e||typeof e!="object")throw Error(qe+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,se,"rounding",0,8,"toExpNeg",-ge,0,"toExpPos",0,ge,"maxE",0,ge,"minE",-ge,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=ut[n]),(r=e[n])!==void 0)if(q(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(oe+n+": "+r);if(n="crypto",i&&(this[n]=ut[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Xt);else this[n]=!1;else throw Error(oe+n+": "+r);return this}function cr(e){return new this(e).cos()}function lr(e){return new this(e).cosh()}function un(e){var t,n,r;function i(o){var s,u,c,a=this;if(!(a instanceof i))return new i(o);if(a.constructor=i,Qt(o)){a.s=o.s,P?!o.d||o.e>i.maxE?(a.e=NaN,a.d=null):o.e<i.minE?(a.e=0,a.d=[0]):(a.e=o.e,a.d=o.d.slice()):(a.e=o.e,a.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){a.s=1/o<0?-1:1,a.e=0,a.d=[0];return}if(o<0?(o=-o,a.s=-1):a.s=1,o===~~o&&o<1e7){for(s=0,u=o;u>=10;u/=10)s++;P?s>i.maxE?(a.e=NaN,a.d=null):s<i.minE?(a.e=0,a.d=[0]):(a.e=s,a.d=[o]):(a.e=s,a.d=[o]);return}else if(o*0!==0){o||(a.s=NaN),a.e=NaN,a.d=null;return}return lt(a,o.toString())}else if(c!=="string")throw Error(oe+o);return(u=o.charCodeAt(0))===45?(o=o.slice(1),a.s=-1):(u===43&&(o=o.slice(1)),a.s=1),en.test(o)?lt(a,o):Yn(a,o)}if(i.prototype=g,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=ar,i.clone=un,i.isDecimal=Qt,i.abs=Zn,i.acos=Jn,i.acosh=Xn,i.add=$n,i.asin=er,i.asinh=tr,i.atan=nr,i.atanh=rr,i.atan2=ir,i.cbrt=or,i.ceil=sr,i.clamp=ur,i.cos=cr,i.cosh=lr,i.div=fr,i.exp=pr,i.floor=dr,i.hypot=mr,i.ln=gr,i.log=hr,i.log10=yr,i.log2=br,i.max=wr,i.min=xr,i.mod=Tr,i.mul=Pr,i.pow=Ar,i.random=Br,i.round=Sr,i.sign=Lr,i.sin=Nr,i.sinh=kr,i.sqrt=Cr,i.sub=Er,i.sum=Dr,i.tan=Rr,i.tanh=Mr,i.trunc=Ir,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function fr(e,t){return new this(e).div(t)}function pr(e){return new this(e).exp()}function dr(e){return x(e=new this(e),e.e+1,3)}function mr(){var e,t,n=new this(0);for(P=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return P=!0,new this(1/0);n=t}return P=!0,n.sqrt()}function Qt(e){return e instanceof Ge||e&&e.toStringTag===$t||!1}function gr(e){return new this(e).ln()}function hr(e,t){return new this(e).log(t)}function br(e){return new this(e).log(2)}function yr(e){return new this(e).log(10)}function wr(){return rn(this,arguments,"lt")}function xr(){return rn(this,arguments,"gt")}function Tr(e,t){return new this(e).mod(t)}function Pr(e,t){return new this(e).mul(t)}function Ar(e,t){return new this(e).pow(t)}function Br(e){var t,n,r,i,o=0,s=new this(1),u=[];if(e===void 0?e=this.precision:z(e,1,se),r=Math.ceil(e/T),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:u[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(u.push(i%1e7),o+=4);o=r/4}else throw Error(Xt);else for(;o<r;)u[o++]=Math.random()*1e7|0;for(r=u[--o],e%=T,r&&e&&(i=K(10,T-e),u[o]=(r/i|0)*i);u[o]===0;o--)u.pop();if(o<0)n=0,u=[0];else{for(n=-1;u[0]===0;n-=T)u.shift();for(r=1,i=u[0];i>=10;i/=10)r++;r<T&&(n-=T-r)}return s.e=n,s.d=u,s}function Sr(e){return x(e=new this(e),e.e+1,this.rounding)}function Lr(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Nr(e){return new this(e).sin()}function kr(e){return new this(e).sinh()}function Cr(e){return new this(e).sqrt()}function Er(e,t){return new this(e).sub(t)}function Dr(){var e=0,t=arguments,n=new this(t[e]);for(P=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return P=!0,x(n,this.precision,this.rounding)}function Rr(e){return new this(e).tan()}function Mr(e){return new this(e).tanh()}function Ir(e){return x(e=new this(e),e.e+1,1)}g[Symbol.for("nodejs.util.inspect.custom")]=g.toString;g[Symbol.toStringTag]="Decimal";var Ge=g.constructor=un(ut);Fe=new Ge(Fe);Oe=new Ge(Oe);import{PublicKey as dt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Kr}from"@solana/spl-token";import{PublicKey as R,SystemProgram as vr,SYSVAR_RENT_PUBKEY as _r}from"@solana/web3.js";function pt({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var Fi=[pt({pubkey:Kr,isWritable:!1}),pt({pubkey:vr.programId,isWritable:!1}),pt({pubkey:_r,isWritable:!1})];function cn({publicKey:e,transformSol:t}){let n=ln(e.toString());if(n instanceof R)return t&&n.equals(Be)?an:n;if(t&&n.toString()===Be.toBase58())return an;if(typeof n=="string"){if(n===R.default.toBase58())return R.default;try{return new R(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function ln(e){try{return new R(e)}catch{return e}}var Oi=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Vi=new R("SysvarRent111111111111111111111111111111111"),qi=new R("SysvarC1ock11111111111111111111111111111111"),Wi=new R("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Ui=new R("Sysvar1nstructions1111111111111111111111111"),Gi=new R("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),zi=new R("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Hi=new R("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),ji=new R("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Yi=new R("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Qi=new R("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Zi=new R("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Ji=new R("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Xi=new R("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),$i=new R("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),eo=new R("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),an=new R("So11111111111111111111111111111111111111112"),Be=R.default;import{PublicKey as Fr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as fn}from"@solana/spl-token";var pn={chainId:101,address:Fr.default.toBase58(),programId:fn.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},pe={chainId:101,address:"So11111111111111111111111111111111111111112",programId:fn.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var mt=class{constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===Be.toBase58()||t instanceof dt&&Be.equals(t)){this.decimals=pe.decimals,this.symbol=pe.symbol,this.name=pe.name,this.mint=new dt(pe.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?dt.default:cn({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},be=mt;be.WSOL=new mt(ne(_({},pe),{mint:pe.address}));import He from"big.js";import qr from"bn.js";import Wr from"decimal.js-light";import Or from"toformat";var Vr=Or,Se=Vr;var ze=V("module/fraction"),gt=Se(He),Le=Se(Wr),Ur={[0]:Le.ROUND_DOWN,[1]:Le.ROUND_HALF_UP,[2]:Le.ROUND_UP},Gr={[0]:He.roundDown,[1]:He.roundHalfUp,[2]:He.roundUp},D=class{constructor(t,n=new qr(1)){this.numerator=ue(t),this.denominator=ue(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new D(this.denominator,this.numerator)}add(t){let n=t instanceof D?t:new D(ue(t));return this.denominator.eq(n.denominator)?new D(this.numerator.add(n.numerator),this.denominator):new D(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof D?t:new D(ue(t));return this.denominator.eq(n.denominator)?new D(this.numerator.sub(n.numerator),this.denominator):new D(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof D?t:new D(ue(t));return new D(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof D?t:new D(ue(t));return new D(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||ze.logWithError(`${t} is not an integer.`),t<=0&&ze.logWithError(`${t} is not positive.`),Le.set({precision:t+1,rounding:Ur[r]});let i=new Le(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||ze.logWithError(`${t} is not an integer.`),t<0&&ze.logWithError(`${t} is negative.`),gt.DP=t,gt.RM=Gr[r]||1,new gt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var No=V("Raydium_price");var ht=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},je=ht;je.SOL=new ht(pn);import Hr from"bn.js";var Ko=new D(new Hr(100));var Ye=new H(0),ts=new H(1),ns=new H(2),rs=new H(3),is=new H(5),jr=new H(10),os=new H(100),ss=new H(1e3),us=new H(1e4),hn=9007199254740991;function ue(e){let t=V("Raydium_parseBigNumberish");if(e instanceof H)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new H(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=hn||e<=-hn)&&t.logWithError(`BigNumberish number overflow: ${e}`),new H(String(e))):typeof e=="bigint"?new H(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new H(0))}var Ts=V("Raydium_amount"),Ps=Se(Yr);function bt(e,t=1,n=[]){let r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}import{PublicKey as j}from"@solana/web3.js";var Us=new j("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Gs=new j("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),zs=new j("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Hs=new j("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),js=new j("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Ys=new j("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Qs=new j("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Zs=new j("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Js=new j("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Xs=new j("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),$s=new j("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),eu=new j("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),tu=new j("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),nu=new j("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi");import{PublicKey as su}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as cu}from"@solana/spl-token";import pu from"bn.js";var yt=V("Raydium_accountInfo_util");async function bn(e,t,n){let{batchRequest:r,commitment:i="confirmed"}=_({batchRequest:!1},n),o=bt(t,100),s=new Array(o.length).fill([]);if(r){let u=o.map(f=>{let l=e._buildArgs([f.map(p=>p.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:l}}),c=bt(u,10);s=(await(await Promise.all(c.map(async f=>await e._rpcBatchRequest(f)))).flat()).map(f=>(f.error&&yt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${f.error.message}`),f.result.value.map(l=>{if(l){let{data:p,executable:m,lamports:h,owner:d,rentEpoch:w}=l;return p.length!==2&&p[1]!=="base64"&&yt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:m,lamports:h,owner:new Qr(d),rentEpoch:w}}return null})))}else try{s=await Promise.all(o.map(u=>e.getMultipleAccountsInfo(u,i)))}catch(u){u instanceof Error&&yt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${u.message}`)}return s.flat()}async function wt({connection:e,address:t}){let n=await bn(e,[...new Set(t.map(i=>i.toString()))].map(i=>new yn(i))),r={};for(let i=0;i<t.length;i++){let o=n[i],s=t[i];if(!o)continue;let u=new Qe({key:s,state:Qe.deserialize(o.data)});r[s.toString()]=u,Ze[s.toString()]=u}return r}var Ze={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new Qe({key:new yn("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:Qe.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};var Je=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let t=(await Zr.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:n}=(r=t==null?void 0:t[15])!=null?r:{};if(!!n)return{units:6e5,microLamports:Math.min(Math.ceil(n*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:n,instructionTypes:r}=ve(t);return this.instructions.unshift(...n),this.instructionTypes.unshift(...r),!0}return!1}async calComputeBudget({config:t,defaultIns:n}){try{let r=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;n&&this.instructions.unshift(...n)}catch{n&&this.instructions.unshift(...n)}}addInstruction({instructions:t=[],endInstructions:n=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:o=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...n),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...o),this.lookupTableAddress.push(...s.filter(u=>u!==Ne.default.toString())),this}async versionBuild({txVersion:t,extInfo:n}){return t===0?await this.buildV0(_({},n||{})):this.build(n)}build(t){let n=new ke;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,{builder:this,transaction:n,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async()=>{var i;let r=await me(this.connection);if(n.recentBlockhash=r,this.signers.length&&n.sign(...this.signers),fe([n]),(i=this.owner)!=null&&i.isKeyPair)return{txId:await xt(this.connection,n,this.signers),signedTx:n};if(this.signAllTransactions){let o=await this.signAllTransactions([n]);return{txId:await this.connection.sendRawTransaction(o[0].serialize(),{skipPreflight:!0}),signedTx:o[0]}}throw new Error("please connect wallet first")},extInfo:t||{}}}buildMultiTx(t){let{extraPreBuildData:n=[],extInfo:r}=t,{transaction:i}=this.build(r),o=n.filter(a=>a.transaction.instructions.length>0),s=[i,...o.map(a=>a.transaction)],u=[this.signers,...o.map(a=>a.signers)],c=[...this.instructionTypes,...o.map(a=>a.instructionTypes).flat()];return{builder:this,transactions:s,signers:u,instructionTypes:c,execute:async a=>{var m;let{sequentially:f,onTxUpdate:l}=a||{},p=await me(this.connection);if((m=this.owner)!=null&&m.isKeyPair)return{txIds:await await Promise.all(s.map(async(h,d)=>(h.recentBlockhash=p,await xt(this.connection,h,u[d])))),signedTxs:s};if(this.signAllTransactions){let h=s.map((w,b)=>(w.recentBlockhash=p,u[b].length&&w.sign(...u[b]),w));fe(h);let d=await this.signAllTransactions(h);if(f){let w=0,b=[],B=async()=>{if(!d[w])return;let y=await this.connection.sendRawTransaction(d[w].serialize(),{skipPreflight:!0});b.push({txId:y,status:"sent",signedTx:d[w]}),l==null||l([...b]),w++,this.connection.onSignature(y,N=>{let A=b.findIndex(k=>k.txId===y);A>-1&&(b[A].status=N.err?"error":"success"),l==null||l([...b]),B()},"processed"),this.connection.getSignatureStatus(y)};return await B(),{txIds:b.map(y=>y.txId),signedTxs:d}}else{let w=[];for(let b=0;b<d.length;b+=1){let B=await this.connection.sendRawTransaction(d[b].serialize(),{skipPreflight:!0});w.push(B)}return{txIds:w,signedTxs:d}}}throw new Error("please connect wallet first")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:n,extInfo:r}){return n===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:r})}async buildV0(t){let p=t||{},{lookupTableCache:n={},lookupTableAddress:r=[],forerunCreate:i}=p,o=Ke(p,["lookupTableCache","lookupTableAddress","forerunCreate"]),s=_(_({},Ze),n),u=Array.from(new Set([...r,...this.lookupTableAddress])),c=[];for(let m of u)s[m]===void 0&&c.push(new Ne(m));let a=await wt({connection:this.connection,address:c});for(let[m,h]of Object.entries(a))s[m]=h;let f=new Ce({payerKey:this.feePayer,recentBlockhash:i?Ne.default.toBase58():await me(this.connection),instructions:[...this.allInstructions]}).compileToV0Message(Object.values(s)),l=new Ee(f);return l.sign(this.signers),{builder:this,transaction:l,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async()=>{var m;if(fe([l]),(m=this.owner)!=null&&m.isKeyPair)return l.sign([this.owner.signer]),{txId:await this.connection.sendTransaction(l,{skipPreflight:!0}),signedTx:l};if(this.signAllTransactions){let h=await this.signAllTransactions([l]);return{txId:await this.connection.sendTransaction(h[0],{skipPreflight:!0}),signedTx:h[0]}}throw new Error("please connect wallet first")},extInfo:o||{}}}async buildV0MultiTx(t){let{extraPreBuildData:n=[],buildProps:r}=t,{transaction:i}=await this.buildV0(r),o=n.filter(a=>a.builder.instructions.length>0),s=[i,...o.map(a=>a.transaction)],u=[this.signers,...o.map(a=>a.signers)],c=[...this.instructionTypes,...o.map(a=>a.instructionTypes).flat()];return s.forEach(async(a,f)=>{a.sign(u[f])}),{builder:this,transactions:s,signers:u,instructionTypes:c,buildProps:r,execute:async a=>{var p;fe(s);let{sequentially:f,onTxUpdate:l}=a||{};if((p=this.owner)!=null&&p.isKeyPair)return s.forEach(m=>m.sign([this.owner.signer])),{txIds:await Promise.all(s.map(async m=>await this.connection.sendTransaction(m))),signedTxs:s};if(this.signAllTransactions){let m=await this.signAllTransactions(s);if(f){let h=0,d=[],w=async()=>{if(!m[h])return;let b=await this.connection.sendTransaction(m[h],{skipPreflight:!0});d.push({txId:b,status:"sent",signedTx:m[h]}),l==null||l([...d]),h++,this.connection.onSignature(b,B=>{let y=d.findIndex(N=>N.txId===b);y>-1&&(d[y].status=B.err?"error":"success"),l==null||l([...d]),w()},"processed"),this.connection.getSignatureStatus(b)};return w(),{txIds:[],signedTxs:m}}else{let h=[];for(let d=0;d<m.length;d+=1){let w=await this.connection.sendTransaction(m[d],{skipPreflight:!0});h.push(w)}return{txIds:h,signedTxs:m}}}throw new Error("please connect wallet first")},extInfo:r||{}}}async sizeCheckBuild(t){let a=t||{},{autoComputeBudget:n=!1}=a,r=Ke(a,["autoComputeBudget"]),i={instructions:[],instructionTypes:[]};if(n){let f=n?await this.getComputeBudgetConfig():void 0;i=n&&f?ve(f):{instructions:[],instructionTypes:[]}}let o=this.signers.reduce((f,l)=>ne(_({},f),{[l.publicKey.toBase58()]:l}),{}),s=[],u=[],c=[];if(this.allInstructions.forEach(f=>{let l=[...c,f],p=n?[...i.instructions,...l]:l,h=[...new Set(l.map(d=>d.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat()).values()].map(d=>new Ne(d));if(c.length<12&&Te({instructions:p,payer:this.feePayer,signers:h})||Te({instructions:l,payer:this.feePayer,signers:h}))c.push(f);else{if(c.length===0)throw Error("item ins too big");Te({instructions:n?[...i.instructions,...c]:[...c],payer:this.feePayer,signers:h})?s.push(new ke().add(...i.instructions,...c)):s.push(new ke().add(...c)),u.push(Array.from(new Set(c.map(d=>d.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat())).map(d=>o[d]).filter(d=>d!==void 0)),c=[f]}}),c.length>0){let l=[...new Set(c.map(p=>p.keys.filter(m=>m.isSigner).map(m=>m.pubkey.toString())).flat()).values()].map(p=>o[p]).filter(p=>p!==void 0);Te({instructions:n?[...i.instructions,...c]:[...c],payer:this.feePayer,signers:l.map(p=>p.publicKey)})?s.push(new ke().add(...i.instructions,...c)):s.push(new ke().add(...c)),u.push(l)}return s.forEach(f=>f.feePayer=this.feePayer),{builder:this,transactions:s,signers:u,instructionTypes:this.instructionTypes,execute:async f=>{var h;let{sequentially:l,onTxUpdate:p}=f||{},m=await me(this.connection);if(s.forEach(async(d,w)=>{d.recentBlockhash=m,u[w].length&&d.sign(...u[w])}),fe(s),(h=this.owner)!=null&&h.isKeyPair)return{txIds:await Promise.all(s.map(async(d,w)=>await xt(this.connection,d,u[w]))),signedTxs:s};if(this.signAllTransactions){let d=await this.signAllTransactions(s);if(l){let w=0,b=[],B=async()=>{if(!d[w])return;let y=await this.connection.sendRawTransaction(d[w].serialize(),{skipPreflight:!0});b.push({txId:y,status:"sent",signedTx:d[w]}),p==null||p([...b]),w++,this.connection.onSignature(y,N=>{let A=b.findIndex(k=>k.txId===y);A>-1&&(b[A].status=N.err?"error":"success"),p==null||p([...b]),B()},"processed"),this.connection.getSignatureStatus(y)};return await B(),{txIds:b.map(y=>y.txId),signedTxs:d}}else{let w=[];for(let b=0;b<d.length;b+=1){let B=await this.connection.sendRawTransaction(d[b].serialize(),{skipPreflight:!0});w.push(B)}return{txIds:w,signedTxs:d}}}throw new Error("please connect wallet first")},extInfo:r||{}}}async sizeCheckBuildV0(t){let w=t||{},{autoComputeBudget:n=!1,lookupTableCache:r={},lookupTableAddress:i=[]}=w,o=Ke(w,["autoComputeBudget","lookupTableCache","lookupTableAddress"]),s=_(_({},Ze),r),u=Array.from(new Set([...this.lookupTableAddress,...i])),c=[];for(let b of u)s[b]===void 0&&c.push(new Ne(b));let a=await wt({connection:this.connection,address:c});for(let[b,B]of Object.entries(a))s[b]=B;let f={instructions:[],instructionTypes:[]};if(n){let b=n?await this.getComputeBudgetConfig():void 0;f=n&&b?ve(b):{instructions:[],instructionTypes:[]}}let l=await me(this.connection),p=this.signers.reduce((b,B)=>ne(_({},b),{[B.publicKey.toBase58()]:B}),{}),m=[],h=[],d=[];if(this.allInstructions.forEach(b=>{let B=[...d,b],y=n?[...f.instructions,...B]:B;if(d.length<12&&Pe({instructions:y,payer:this.feePayer,lookupTableAddressAccount:s})||Pe({instructions:B,payer:this.feePayer,lookupTableAddressAccount:s}))d.push(b);else{if(d.length===0)throw Error("item ins too big");let N={};for(let A of[...new Set(u)])s[A]!==void 0&&(N[A]=s[A]);if(n&&Pe({instructions:[...f.instructions,...d],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:l})){let A=new Ce({payerKey:this.feePayer,recentBlockhash:l,instructions:[...f.instructions,...d]}).compileToV0Message(Object.values(s));m.push(new Ee(A))}else{let A=new Ce({payerKey:this.feePayer,recentBlockhash:l,instructions:[...d]}).compileToV0Message(Object.values(s));m.push(new Ee(A))}h.push(Array.from(new Set(d.map(A=>A.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat())).map(A=>p[A]).filter(A=>A!==void 0)),d=[b]}}),d.length>0){let B=[...new Set(d.map(y=>y.keys.filter(N=>N.isSigner).map(N=>N.pubkey.toString())).flat()).values()].map(y=>p[y]).filter(y=>y!==void 0);if(n&&Pe({instructions:[...f.instructions,...d],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:l})){let y=new Ce({payerKey:this.feePayer,recentBlockhash:l,instructions:[...f.instructions,...d]}).compileToV0Message(Object.values(s));m.push(new Ee(y))}else{let y=new Ce({payerKey:this.feePayer,recentBlockhash:l,instructions:[...d]}).compileToV0Message(Object.values(s));m.push(new Ee(y))}h.push(B)}return{builder:this,transactions:m,buildProps:t,signers:h,instructionTypes:this.instructionTypes,execute:async b=>{var N;let{sequentially:B,onTxUpdate:y}=b||{};if(m.map(async(A,k)=>{h[k].length&&A.sign(h[k])}),fe(m),(N=this.owner)!=null&&N.isKeyPair)return{txIds:await Promise.all(m.map(async A=>await this.connection.sendTransaction(A,{skipPreflight:!0}))),signedTxs:m};if(this.signAllTransactions){let A=await this.signAllTransactions(m);if(B){let k=0,v=[],Y=async()=>{if(!A[k])return;let Q=await this.connection.sendTransaction(A[k],{skipPreflight:!0});v.push({txId:Q,status:"sent",signedTx:A[k]}),y==null||y([...v]),k++,this.connection.onSignature(Q,U=>{let M=v.findIndex(te=>te.txId===Q);M>-1&&(v[M].status=U.err?"error":"success"),y==null||y([...v]),Y()},"processed"),this.connection.getSignatureStatus(Q)};return Y(),{txIds:[],signedTxs:A}}else{let k=[];for(let v=0;v<A.length;v+=1){let Y=await this.connection.sendTransaction(A[v],{skipPreflight:!0});k.push(Y)}return{txIds:k,signedTxs:A}}}throw new Error("please connect wallet first")},extInfo:o||{}}}};var Tt=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),De=class{constructor({scope:t,moduleName:n}){this.disabled=!1;this.scope=t,this.logger=V(n)}createTxBuilder(t){return this.scope.checkOwner(),new Je({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,owner:this.scope.owner,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(Tt(t))}logInfo(...t){this.logger.info(Tt(t))}logAndCreateError(...t){let n=Tt(t);throw new Error(n)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{PublicKey as li,Keypair as fi}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as pi}from"@solana/spl-token";import Sc from"bn.js";import{PublicKey as ii}from"@solana/web3.js";import Tn,{isBN as tc}from"bn.js";import{bits as Jr,BitStructure as ua,blob as Xr,Blob as aa,cstr as ca,f32 as la,f32be as fa,f64 as pa,f64be as da,greedy as ma,Layout as $r,ns64 as ga,ns64be as ha,nu64 as ba,nu64be as ya,offset as wa,s16 as xa,s16be as Ta,s24 as Pa,s24be as Aa,s32 as Ba,s32be as Sa,s40 as La,s40be as Na,s48 as ka,s48be as Ca,s8 as Ea,seq as Da,struct as Ra,Structure as ei,u16 as ti,u16be as Ma,u24 as Ia,u24be as Ka,u32 as ni,u32be as va,u40 as _a,u40be as Fa,u48 as Oa,u48be as Va,u8 as qa,UInt as ri,union as Wa,Union as Ua,unionLayoutDiscriminator as Ga,utf8 as za}from"@solana/buffer-layout";var Xe=$r,wn=ei;var Pt=ri;var xn=ti;var At=ni;var ye=Xr;var Bt=Jr;var St=class extends Xe{constructor(n,r,i){super(n,i);this.blob=ye(n),this.signed=r}decode(n,r=0){let i=new Tn(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new Tn(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}},$e=class extends Xe{constructor(n){super(8,n);this._lower=Bt(At(),!1),this._upper=Bt(At(),!1)}addBoolean(n){this._lower.fields.length<32?this._lower.addBoolean(n):this._upper.addBoolean(n)}decode(n,r=0){let i=this._lower.decode(n,r),o=this._upper.decode(n,r+this._lower.span);return _(_({},i),o)}encode(n,r,i=0){return this._lower.encode(n,r,i)+this._upper.encode(n,r,i+this._lower.span)}};function et(e){return new Pt(1,e)}function we(e){return new Pt(4,e)}function I(e){return new St(8,!1,e)}var Lt=class extends Xe{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function W(e){return new Lt(ye(32),t=>new ii(t),t=>t.toBuffer(),e)}var Nt=class extends wn{decode(t,n){return super.decode(t,n)}};function xe(e,t,n){return new Nt(e,t,n)}var oi=xe([W("mint"),W("owner"),I("amount"),we("delegateOption"),W("delegate"),et("state"),we("isNativeOption"),I("isNative"),I("delegatedAmount"),we("closeAuthorityOption"),W("closeAuthority")]);function si(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function kt(e,...t){if(!si(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Ct(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Pn(e,t){kt(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var nt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),X=(e,t)=>e<<32-t|e>>>t;var cc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ui(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Et(e){return typeof e=="string"&&(e=ui(e)),kt(e),e}var tt=class{clone(){return this._cloneInto()}},lc={}.toString;function An(e){let t=r=>e().update(Et(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ai(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),u=Number(n&o),c=r?4:0,a=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+a,u,r)}var Bn=(e,t,n)=>e&t^~e&n,Sn=(e,t,n)=>e&t^e&n^t&n,rt=class extends tt{constructor(t,n,r,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=nt(this.buffer)}update(t){Ct(this);let{view:n,buffer:r,blockLen:i}=this;t=Et(t);let o=t.length;for(let s=0;s<o;){let u=Math.min(i-this.pos,o-s);if(u===i){let c=nt(t);for(;i<=o-s;s+=i)this.process(c,s);continue}r.set(t.subarray(s,s+u),this.pos),this.pos+=u,s+=u,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ct(this),Pn(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:i,isLE:o}=this,{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let l=s;l<i;l++)n[l]=0;ai(r,i-8,BigInt(this.length*8),o),this.process(r,0);let u=nt(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=c/4,f=this.get();if(a>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<a;l++)u.setUint32(4*l,f[l],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:i,finished:o,destroyed:s,pos:u}=this;return t.length=i,t.pos=u,t.finished=o,t.destroyed=s,i%n&&t.buffer.set(r),t}};var ci=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ae=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ce=new Uint32Array(64),Dt=class extends rt{constructor(){super(64,32,8,!1),this.A=ae[0]|0,this.B=ae[1]|0,this.C=ae[2]|0,this.D=ae[3]|0,this.E=ae[4]|0,this.F=ae[5]|0,this.G=ae[6]|0,this.H=ae[7]|0}get(){let{A:t,B:n,C:r,D:i,E:o,F:s,G:u,H:c}=this;return[t,n,r,i,o,s,u,c]}set(t,n,r,i,o,s,u,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=u|0,this.H=c|0}process(t,n){for(let l=0;l<16;l++,n+=4)ce[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){let p=ce[l-15],m=ce[l-2],h=X(p,7)^X(p,18)^p>>>3,d=X(m,17)^X(m,19)^m>>>10;ce[l]=d+ce[l-7]+h+ce[l-16]|0}let{A:r,B:i,C:o,D:s,E:u,F:c,G:a,H:f}=this;for(let l=0;l<64;l++){let p=X(u,6)^X(u,11)^X(u,25),m=f+p+Bn(u,c,a)+ci[l]+ce[l]|0,d=(X(r,2)^X(r,13)^X(r,22))+Sn(r,i,o)|0;f=a,a=c,c=u,u=s+m|0,s=o,o=i,i=r,r=m+d|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,u=u+this.E|0,c=c+this.F|0,a=a+this.G|0,f=f+this.H|0,this.set(r,i,o,s,u,c,a,f)}roundClean(){ce.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Ln=An(()=>new Dt);var Cc=V("Raydium_Util");function le({fromPublicKey:e,programId:t=pi}){let n=fi.generate().publicKey.toBase58().slice(0,32);return{publicKey:di(e,n,t),seed:n}}function di(e,t,n){let r=Buffer.concat([e.toBuffer(),Buffer.from(t),n.toBuffer()]),i=Ln(r);return new li(i)}import{TransactionInstruction as gi,SYSVAR_RENT_PUBKEY as hi}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Nn}from"@solana/spl-token";import{createInitializeAccountInstruction as kn}from"@solana/spl-token";import{SystemProgram as de,Transaction as Cn}from"@solana/web3.js";function mi(e="accountFlags"){let t=new $e(e);return t.addBoolean("initialized"),t.addBoolean("market"),t.addBoolean("openOrders"),t.addBoolean("requestQueue"),t.addBoolean("eventQueue"),t.addBoolean("bids"),t.addBoolean("asks"),t}var Rt=xe([ye(5),mi("accountFlags"),W("ownAddress"),I("vaultSignerNonce"),W("baseMint"),W("quoteMint"),W("baseVault"),I("baseDepositsTotal"),I("baseFeesAccrued"),W("quoteVault"),I("quoteDepositsTotal"),I("quoteFeesAccrued"),I("quoteDustThreshold"),W("requestQueue"),W("eventQueue"),W("bids"),W("asks"),I("baseLotSize"),I("quoteLotSize"),I("feeRateBps"),I("referrerRebatesAccrued"),ye(7)]);function bi({programId:e,marketInfo:t}){let n=xe([et("version"),we("instruction"),I("baseLotSize"),I("quoteLotSize"),xn("feeRateBps"),I("vaultSignerNonce"),I("quoteDustThreshold")]),r=[{pubkey:t.id,isSigner:!1,isWritable:!0},{pubkey:t.requestQueue,isSigner:!1,isWritable:!0},{pubkey:t.eventQueue,isSigner:!1,isWritable:!0},{pubkey:t.bids,isSigner:!1,isWritable:!0},{pubkey:t.asks,isSigner:!1,isWritable:!0},{pubkey:t.baseVault,isSigner:!1,isWritable:!0},{pubkey:t.quoteVault,isSigner:!1,isWritable:!0},{pubkey:t.baseMint,isSigner:!1,isWritable:!1},{pubkey:t.quoteMint,isSigner:!1,isWritable:!1},{pubkey:t.authority?t.quoteMint:hi,isSigner:!1,isWritable:!1}].concat(t.authority?{pubkey:t.authority,isSigner:!1,isWritable:!1}:[]).concat(t.authority&&t.pruneAuthority?{pubkey:t.pruneAuthority,isSigner:!1,isWritable:!1}:[]),i=Buffer.alloc(n.span);return n.encode({version:0,instruction:0,baseLotSize:t.baseLotSize,quoteLotSize:t.quoteLotSize,feeRateBps:t.feeRateBps,vaultSignerNonce:t.vaultSignerNonce,quoteDustThreshold:t.quoteDustThreshold},i),new gi({keys:r,programId:e,data:i})}async function En({connection:e,wallet:t,marketInfo:n}){let r=new Cn,i=await e.getMinimumBalanceForRentExemption(165);r.add(de.createAccountWithSeed({fromPubkey:t,basePubkey:t,seed:n.baseVault.seed,newAccountPubkey:n.baseVault.publicKey,lamports:i,space:165,programId:Nn}),de.createAccountWithSeed({fromPubkey:t,basePubkey:t,seed:n.quoteVault.seed,newAccountPubkey:n.quoteVault.publicKey,lamports:i,space:165,programId:Nn}),kn(n.baseVault.publicKey,n.baseMint,n.vaultOwner),kn(n.quoteVault.publicKey,n.quoteMint,n.vaultOwner));let o=new Cn;return o.add(de.createAccountWithSeed({fromPubkey:t,basePubkey:t,seed:n.id.seed,newAccountPubkey:n.id.publicKey,lamports:await e.getMinimumBalanceForRentExemption(Rt.span),space:Rt.span,programId:n.programId}),de.createAccountWithSeed({fromPubkey:t,basePubkey:t,seed:n.requestQueue.seed,newAccountPubkey:n.requestQueue.publicKey,lamports:await e.getMinimumBalanceForRentExemption(5120+12),space:5120+12,programId:n.programId}),de.createAccountWithSeed({fromPubkey:t,basePubkey:t,seed:n.eventQueue.seed,newAccountPubkey:n.eventQueue.publicKey,lamports:await e.getMinimumBalanceForRentExemption(262144+12),space:262144+12,programId:n.programId}),de.createAccountWithSeed({fromPubkey:t,basePubkey:t,seed:n.bids.seed,newAccountPubkey:n.bids.publicKey,lamports:await e.getMinimumBalanceForRentExemption(65536+12),space:65536+12,programId:n.programId}),de.createAccountWithSeed({fromPubkey:t,basePubkey:t,seed:n.asks.seed,newAccountPubkey:n.asks.publicKey,lamports:await e.getMinimumBalanceForRentExemption(65536+12),space:65536+12,programId:n.programId}),bi({programId:n.programId,marketInfo:{id:n.id.publicKey,requestQueue:n.requestQueue.publicKey,eventQueue:n.eventQueue.publicKey,bids:n.bids.publicKey,asks:n.asks.publicKey,baseVault:n.baseVault.publicKey,quoteVault:n.quoteVault.publicKey,baseMint:n.baseMint,quoteMint:n.quoteMint,baseLotSize:n.baseLotSize,quoteLotSize:n.quoteLotSize,feeRateBps:n.feeRateBps,vaultSignerNonce:n.vaultSignerNonce,quoteDustThreshold:n.quoteDustThreshold}})),[{transaction:r,signer:[],instructionTypes:[G.CreateAccount,G.CreateAccount,G.InitAccount,G.InitAccount]},{transaction:o,signer:[],instructionTypes:[G.CreateAccount,G.CreateAccount,G.CreateAccount,G.CreateAccount,G.CreateAccount,G.InitMarket]}]}var It=class extends De{async create({baseInfo:t,quoteInfo:n,lotSize:r,tickSize:i,dexProgramId:o,txVersion:s,computeBudgetConfig:u}){let c=this.scope.ownerPubKey,a=le({fromPublicKey:c,programId:o}),f=le({fromPublicKey:c,programId:o}),l=le({fromPublicKey:c,programId:o}),p=le({fromPublicKey:c,programId:o}),m=le({fromPublicKey:c,programId:o}),h=le({fromPublicKey:c,programId:Dn}),d=le({fromPublicKey:c,programId:Dn}),w=0,b=new Re(100);function B(){let U=new Re(0);for(;;)try{return{vaultOwner:Mt.createProgramAddressSync([a.publicKey.toBuffer(),U.toArrayLike(Buffer,"le",8)],o),vaultSignerNonce:U}}catch{if(U.iaddn(1),U.gt(new Re(25555)))throw Error("find vault owner error")}}let{vaultOwner:y,vaultSignerNonce:N}=B(),A=new Re(Math.round(10**t.decimals*r)),k=new Re(Math.round(r*10**n.decimals*i));if(A.eq(Ye))throw Error("lot size is too small");if(k.eq(Ye))throw Error("tick size or lot size is too small");let v=await En({connection:this.scope.connection,wallet:this.scope.ownerPubKey,marketInfo:{programId:o,id:a,baseMint:t.mint,quoteMint:n.mint,baseVault:h,quoteVault:d,vaultOwner:y,requestQueue:f,eventQueue:l,bids:p,asks:m,feeRateBps:w,quoteDustThreshold:b,vaultSignerNonce:N,baseLotSize:A,quoteLotSize:k}}),Y=this.createTxBuilder();Y.addCustomComputeBudget(u),Y.addInstruction({instructions:v[0].transaction.instructions,signers:v[0].signer});let Q=[];for await(let U of v.slice(1,v.length)){let M=this.createTxBuilder();M.addCustomComputeBudget(u),M.addInstruction({instructions:U.transaction.instructions,signers:U.signer,instructionTypes:U.instructionTypes});let te=await M.versionBuild({txVersion:s});Q.push(te)}return Y.versionMultiBuild({extraPreBuildData:Q,extInfo:{address:{marketId:a.publicKey,requestQueue:f.publicKey,eventQueue:l.publicKey,bids:p.publicKey,asks:m.publicKey,baseVault:h.publicKey,quoteVault:d.publicKey,baseMint:new Mt(t.mint),quoteMin:new Mt(n.mint)}},txVersion:s})}};export{It as default};
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=createMarket.mjs.map