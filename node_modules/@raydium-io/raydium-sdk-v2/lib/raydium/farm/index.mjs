var _r=Object.defineProperty,Wr=Object.defineProperties;var Mr=Object.getOwnPropertyDescriptors;var Mt=Object.getOwnPropertySymbols;var Or=Object.prototype.hasOwnProperty,Ur=Object.prototype.propertyIsEnumerable;var Ot=(e,t,r)=>t in e?_r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,U=(e,t)=>{for(var r in t||(t={}))Or.call(t,r)&&Ot(e,r,t[r]);if(Mt)for(var r of Mt(t))Ur.call(t,r)&&Ot(e,r,t[r]);return e},z=(e,t)=>Wr(e,Mr(t));import{PublicKey as Zr}from"@solana/web3.js";import jt,{isBN as Yt}from"bn.js";import{bits as qi,BitStructure as Gi,blob as qr,Blob as ji,cstr as Yi,f32 as Hi,f32be as zi,f64 as Zi,f64be as Xi,greedy as Ji,Layout as Gr,ns64 as Qi,ns64be as $i,nu64 as eo,nu64be as to,offset as ro,s16 as no,s16be as io,s24 as oo,s24be as so,s32 as ao,s32be as uo,s40 as co,s40be as lo,s48 as fo,s48be as po,s8 as mo,seq as jr,struct as go,Structure as Yr,u16 as yo,u16be as bo,u24 as ho,u24be as wo,u32 as Po,u32be as To,u40 as xo,u40be as So,u48 as ko,u48be as Ao,u8 as Hr,UInt as zr,union as Lo,Union as Io,unionLayoutDiscriminator as Bo,utf8 as Ro}from"@solana/buffer-layout";var st=Gr,Ut=Yr;var at=zr;var qt=Hr;var Gt=jr;var ye=qr;var ke=class extends st{constructor(r,n,i){super(r,i);this.blob=ye(r),this.signed=n}decode(r,n=0){let i=new jt(this.blob.decode(r,n),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(r,n,i=0){return typeof r=="number"&&(r=new jt(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),n,i)}};function V(e){return new at(1,e)}function Ae(e){return new at(4,e)}function y(e){return new ke(8,!1,e)}function se(e){return new ke(16,!1,e)}function Ht(e){return new ke(1,!0,e)}function qe(e){return new ke(8,!0,e)}var Ue=class extends st{constructor(r,n,i,o){super(r.span,o);this.layout=r,this.decoder=n,this.encoder=i}decode(r,n){return this.decoder(this.layout.decode(r,n))}encode(r,n,i){return this.layout.encode(this.encoder(r),n,i)}getSpan(r,n){return this.layout.getSpan(r,n)}};function A(e){return new Ue(ye(32),t=>new Zr(t),t=>t.toBuffer(),e)}function Ke(e){return new Ue(qt(),Xr,Jr,e)}function Xr(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function Jr(e){return e?1:0}var ut=class extends Ut{decode(t,r){return super.decode(t,r)}};function N(e,t,r){return new ut(e,t,r)}function D(e,t,r){let n,i=typeof t=="number"?t:Yt(t)?t.toNumber():new Proxy(t,{get(o,s){if(!n){let a=Reflect.get(o,"count");n=Yt(a)?a.toNumber():a,Reflect.set(o,"count",n)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(n=a),Reflect.set(o,s,a)}});return Gt(e,i,r)}import{PublicKey as er}from"@solana/web3.js";import{get as zt,set as Qr}from"lodash";import Xt from"dayjs";import $r from"dayjs/plugin/utc";Xt.extend($r);var ct=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Xt().utc().format("YYYY/MM/DD HH:mm:ss UTC")}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let r=t.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(r)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Zt={},en={};function W(e){let t=zt(Zt,e);if(!t){let r=zt(en,e);t=new ct({name:e,logLevel:r}),Qr(Zt,e,t)}return t}import{PublicKey as Z}from"@solana/web3.js";var Jt=new Z("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Qt=new Z("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),$t=new Z("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Ho=new Z("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),zo=new Z("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Zo=new Z("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Xo=new Z("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Jo=new Z("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Qo=new Z("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),$o=new Z("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),es=new Z("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),ts=new Z("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),rs=new Z("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),ns=new Z("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi");var ds=W("Raydium_farm_config"),fs=new er("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ps=new er("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1"),tr={3:nr,5:ir,6:or},rr={3:Ve,5:sr,6:ar},ms=e=>[3,5,6].indexOf(e)!==-1,gs=e=>{var s;let{version:t,rewardInfos:r,rewardTokenAccountsPublicKeys:n}=e,i=`rewardInfo:${JSON.stringify(r)}, rewardAccount:${JSON.stringify(n)}`,o={3:()=>{if(r.length!==1||n.length!==1)return`rewardInfos or rewardTokenAccounts lengths not equal 1: ${i}`},5:()=>{if(r.length!==n.length)return`rewardInfos and rewardTokenAccounts lengths not equal: ${i}`},6:()=>{if(!n.length||r.length!==n.length)return`no rewardTokenAccounts or rewardInfos and rewardTokenAccounts lengths not equal: ${i}`}};return(s=o[t])==null?void 0:s.call(o)},Le={"Standard SPL":0,"Option tokens":1},ys={[Jt.toString()]:3,[Qt.toString()]:5,[$t.toString()]:6};var lt=N([V("instruction")]),dt=N([V("instruction")]),tn=N([y("rewardState"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardLastUpdateTime"),y("totalReward"),y("totalRewardEmissioned"),y("rewardClaimed"),y("rewardPerSecond"),se("accRewardPerShare"),A("rewardVault"),A("rewardMint"),A("rewardSender"),y("rewardType"),D(y(),15,"padding")]),rn=N([y("state"),y("nonce"),A("lpVault"),A("rewardVault"),A(),A(),y(),y(),y("totalReward"),se("perShareReward"),y("lastSlot"),y("perSlotReward")]),nn=N([y("state"),y("nonce"),A("lpVault"),A("rewardVaultA"),y("totalRewardA"),se("perShareRewardA"),y("perSlotRewardA"),V("option"),A("rewardVaultB"),ye(7),y("totalRewardB"),se("perShareRewardB"),y("perSlotRewardB"),y("lastSlot"),A()]),on=N([y(),y("state"),y("nonce"),y("validRewardTokenNum"),se("rewardMultiplier"),y("rewardPeriodMax"),y("rewardPeriodMin"),y("rewardPeriodExtend"),A("lpMint"),A("lpVault"),D(tn,5,"rewardInfos"),A("creator"),A(),D(y(),32,"padding")]),nr=new Proxy(rn,{get(e,t,r){return t==="decode"?(...n)=>{let i=e.decode(...n);return z(U({},i),{version:3,rewardInfos:[{rewardVault:i.rewardVault,totalReward:i.totalReward,perSlotReward:i.perSlotReward,perShareReward:i.perShareReward}]})}:Reflect.get(e,t,r)}}),ir=new Proxy(nn,{get(e,t,r){return t==="decode"?(...n)=>{let i=e.decode(...n);return z(U({},i),{version:5,rewardInfos:[{rewardVault:i.rewardVaultA,totalReward:i.totalRewardA,perSlotReward:i.perSlotRewardA,perShareReward:i.perShareRewardA},{rewardVault:i.rewardVaultB,totalReward:i.totalRewardB,perSlotReward:i.perSlotRewardB,perShareReward:i.perShareRewardB}]})}:Reflect.get(e,t,r)}}),or=new Proxy(on,{get(e,t,r){return t==="decode"?(...n)=>{let i=e.decode(...n);return z(U({},i),{version:6,rewardInfos:i.rewardInfos.map(o=>{var s;return z(U({},o),{rewardType:((s=Object.entries(Le).find(a=>String(a[1])===o.rewardType.toString()))!=null?s:["Standard SPL"])[0]})})})}:Reflect.get(e,t,r)}}),sn=N([y("isSet"),y("rewardPerSecond"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardType")]),ft=N([V("instruction"),y("nonce"),D(sn,5,"rewardTimeInfo")]),pt=N([V("instruction"),y("rewardReopenTime"),y("rewardEndTime"),y("rewardPerSecond")]),mt=N([V("instruction"),y("isSet"),y("rewardPerSecond"),y("rewardOpenTime"),y("rewardEndTime"),y("rewardType")]),Ss=N([y("state"),A("id"),A("owner"),y("deposited"),D(y(),1,"rewardDebts")]),Ve=N([y("state"),A("id"),A("owner"),y("deposited"),D(se(),1,"rewardDebts"),y(""),y("voteLockedBalance"),D(y(),15)]),ks=N([y("state"),A("id"),A("owner"),y("deposited"),D(y(),2,"rewardDebts")]),sr=N([y("state"),A("id"),A("owner"),y("deposited"),D(se(),2,"rewardDebts"),D(y(),17)]),ar=N([y(),y("state"),A("id"),A("owner"),y("deposited"),D(se(),5,"rewardDebts"),D(y(),16)]),H=N([V("instruction"),y("amount")]),an=N([A("mint"),A("grantAuthority"),y("baselineVoteWeightScaledFactor"),y("maxExtraLockupVoteWeightScaledFactor"),y("lockupSaturationSecs"),Ht("digitShift"),D(V(),7,"reserved1"),D(y(),7,"reserved2")]),ur=N([ye(8),A("governanceProgramId"),A("realm"),A("realmGoverningTokenMint"),A("realmAuthority"),D(V(),32,"reserved1"),D(an,4,"votingMints"),qe("timeOffset"),V("bump"),D(V(),7,"reserved2"),D(y(),11,"reserved3")]),un=N([qe("startTime"),qe("endTime"),V("kind"),D(V(),15,"reserved")]),cn=N([D(un,1,"lockup"),y("amountDeposited_native"),y("amountInitiallyLockedNative"),Ke("isUsed"),Ke("allowClawback"),V("votingMintConfigIdx"),D(V(),29,"reserved")]),cr=N([ye(8),A("voterAuthority"),A("registrar"),D(cn,32,"deposits"),V("voterBump"),V("voterWweightRecordBump"),D(V(),94,"reserved")]);import Q from"bn.js";import{PublicKey as Ii}from"@solana/web3.js";import{getTransferFeeConfig as Oc,unpackMint as Uc}from"@solana/spl-token";import{PublicKey as Pi}from"@solana/web3.js";import Ti from"bn.js";import bi from"big.js";import rt from"bn.js";import J from"bn.js";var Ie=9e15,me=1e9,gt="0123456789abcdef",je="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ye="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",yt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ie,maxE:Ie,crypto:!1},pr,ae,x=!0,ze="[DecimalError] ",pe=ze+"Invalid argument: ",mr=ze+"Precision limit exceeded",gr=ze+"crypto unavailable",yr="[object Decimal]",j=Math.floor,M=Math.pow,ln=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,dn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,fn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,br=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ne=1e7,P=7,pn=9007199254740991,mn=je.length-1,bt=Ye.length-1,g={toStringTag:yr};g.absoluteValue=g.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),w(e)};g.ceil=function(){return w(new this.constructor(this),this.e+1,2)};g.clampedTo=g.clamp=function(e,t){var r,n=this,i=n.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(pe+t);return r=n.cmp(e),r<0?e:n.cmp(t)>0?t:new i(n)};g.comparedTo=g.cmp=function(e){var t,r,n,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(n=s.length,i=a.length,t=0,r=n<i?n:i;t<r;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return n===i?0:n>i^c<0?1:-1};g.cosine=g.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+P,n.rounding=1,r=gn(n,xr(n,r)),n.precision=e,n.rounding=t,w(ae==2||ae==3?r.neg():r,e,t,!0)):new n(1):new n(NaN)};g.cubeRoot=g.cbrt=function(){var e,t,r,n,i,o,s,a,c,u,l=this,d=l.constructor;if(!l.isFinite()||l.isZero())return new d(l);for(x=!1,o=l.s*M(l.s*l,1/3),!o||Math.abs(o)==1/0?(r=q(l.d),e=l.e,(o=(e-r.length+1)%3)&&(r+=o==1||o==-2?"0":"00"),o=M(r,1/3),e=j((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?r="5e"+e:(r=o.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),n=new d(r),n.s=l.s):n=new d(o.toString()),s=(e=d.precision)+3;;)if(a=n,c=a.times(a).times(a),u=c.plus(l),n=F(u.plus(l).times(a),u.plus(c),s+2,1),q(a.d).slice(0,s)===(r=q(n.d)).slice(0,s))if(r=r.slice(s-3,s+1),r=="9999"||!i&&r=="4999"){if(!i&&(w(a,e+1,0),a.times(a).times(a).eq(l))){n=a;break}s+=4,i=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(w(n,e+1,1),t=!n.times(n).times(n).eq(l));break}return x=!0,w(n,e,d.rounding,t)};g.decimalPlaces=g.dp=function(){var e,t=this.d,r=NaN;if(t){if(e=t.length-1,r=(e-j(this.e/P))*P,e=t[e],e)for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r};g.dividedBy=g.div=function(e){return F(this,new this.constructor(e))};g.dividedToIntegerBy=g.divToInt=function(e){var t=this,r=t.constructor;return w(F(t,new r(e),0,1,1),r.precision,r.rounding)};g.equals=g.eq=function(e){return this.cmp(e)===0};g.floor=function(){return w(new this.constructor(this),this.e+1,3)};g.greaterThan=g.gt=function(e){return this.cmp(e)>0};g.greaterThanOrEqualTo=g.gte=function(e){var t=this.cmp(e);return t==1||t===0};g.hyperbolicCosine=g.cosh=function(){var e,t,r,n,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;r=s.precision,n=s.rounding,s.precision=r+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/Xe(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=Be(s,1,o.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=o.times(o),o=a.minus(c.times(l.minus(c.times(l))));return w(o,s.precision=r,s.rounding=n,!0)};g.hyperbolicSine=g.sinh=function(){var e,t,r,n,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,r=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,n=i.d.length,n<3)i=Be(o,2,i,i,!0);else{e=1.4*Math.sqrt(n),e=e>16?16:e|0,i=i.times(1/Xe(5,e)),i=Be(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=r,w(i,t,r,!0)};g.hyperbolicTangent=g.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,F(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)};g.inverseCosine=g.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),i=r.precision,o=r.rounding;return n!==-1?n===0?t.isNeg()?re(r,i,o):new r(0):new r(NaN):t.isZero()?re(r,i+4,o).times(.5):(r.precision=i+6,r.rounding=1,t=t.asin(),e=re(r,i+4,o).times(.5),r.precision=i,r.rounding=o,e.minus(t))};g.inverseHyperbolicCosine=g.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,x=!1,r=r.times(r).minus(1).sqrt().plus(r),x=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)};g.inverseHyperbolicSine=g.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,x=!1,r=r.times(r).plus(1).sqrt().plus(r),x=!0,n.precision=e,n.rounding=t,r.ln())};g.inverseHyperbolicTangent=g.atanh=function(){var e,t,r,n,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,n=i.sd(),Math.max(n,e)<2*-i.e-1?w(new o(i),e,t,!0):(o.precision=r=n-i.e,i=F(i.plus(1),new o(1).minus(i),r+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};g.inverseSine=g.asin=function(){var e,t,r,n,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),r=o.precision,n=o.rounding,t!==-1?t===0?(e=re(o,r+4,n).times(.5),e.s=i.s,e):new o(NaN):(o.precision=r+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=n,i.times(2)))};g.inverseTangent=g.atan=function(){var e,t,r,n,i,o,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&d+4<=bt)return s=re(l,d+4,f).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(d+4<=bt)return s=re(l,d+4,f).times(.5),s.s=u.s,s}for(l.precision=a=d+10,l.rounding=1,r=Math.min(28,a/P+2|0),e=r;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(x=!1,t=Math.ceil(a/P),n=1,c=u.times(u),s=new l(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(n+=2)),i=i.times(c),s=o.plus(i.div(n+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return r&&(s=s.times(2<<r-1)),x=!0,w(s,l.precision=d,l.rounding=f,!0)};g.isFinite=function(){return!!this.d};g.isInteger=g.isInt=function(){return!!this.d&&j(this.e/P)>this.d.length-2};g.isNaN=function(){return!this.s};g.isNegative=g.isNeg=function(){return this.s<0};g.isPositive=g.isPos=function(){return this.s>0};g.isZero=function(){return!!this.d&&this.d[0]===0};g.lessThan=g.lt=function(e){return this.cmp(e)<0};g.lessThanOrEqualTo=g.lte=function(e){return this.cmp(e)<1};g.logarithm=g.log=function(e){var t,r,n,i,o,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding,m=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),r=e.d,e.s<0||!r||!r[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new l(r&&!r[0]?-1/0:u.s!=1?NaN:r?0:1/0);if(t)if(r.length>1)o=!0;else{for(i=r[0];i%10===0;)i/=10;o=i!==1}if(x=!1,a=d+m,s=fe(u,a),n=t?He(l,a+10):fe(e,a),c=F(s,n,a,1),Fe(c.d,i=d,f))do if(a+=10,s=fe(u,a),n=t?He(l,a+10):fe(e,a),c=F(s,n,a,1),!o){+q(c.d).slice(i+1,i+15)+1==1e14&&(c=w(c,d+1,0));break}while(Fe(c.d,i+=10,f));return x=!0,w(c,d,f)};g.minus=g.sub=function(e){var t,r,n,i,o,s,a,c,u,l,d,f,m=this,h=m.constructor;if(e=new h(e),!m.d||!e.d)return!m.s||!e.s?e=new h(NaN):m.d?e.s=-e.s:e=new h(e.d||m.s!==e.s?m:NaN),e;if(m.s!=e.s)return e.s=-e.s,m.plus(e);if(u=m.d,f=e.d,a=h.precision,c=h.rounding,!u[0]||!f[0]){if(f[0])e.s=-e.s;else if(u[0])e=new h(m);else return new h(c===3?-0:0);return x?w(e,a,c):e}if(r=j(e.e/P),l=j(m.e/P),u=u.slice(),o=l-r,o){for(d=o<0,d?(t=u,o=-o,s=f.length):(t=f,r=l,s=u.length),n=Math.max(Math.ceil(a/P),s)+2,o>n&&(o=n,t.length=1),t.reverse(),n=o;n--;)t.push(0);t.reverse()}else{for(n=u.length,s=f.length,d=n<s,d&&(s=n),n=0;n<s;n++)if(u[n]!=f[n]){d=u[n]<f[n];break}o=0}for(d&&(t=u,u=f,f=t,e.s=-e.s),s=u.length,n=f.length-s;n>0;--n)u[s++]=0;for(n=f.length;n>o;){if(u[--n]<f[n]){for(i=n;i&&u[--i]===0;)u[i]=ne-1;--u[i],u[n]+=ne}u[n]-=f[n]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(e.d=u,e.e=Ze(u,r),x?w(e,a,c):e):new h(c===3?-0:0)};g.modulo=g.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?w(new n(r),n.precision,n.rounding):(x=!1,n.modulo==9?(t=F(r,e.abs(),0,3,1),t.s*=e.s):t=F(r,e,0,n.modulo,1),t=t.times(e),x=!0,r.minus(t))};g.naturalExponential=g.exp=function(){return ht(this)};g.naturalLogarithm=g.ln=function(){return fe(this)};g.negated=g.neg=function(){var e=new this.constructor(this);return e.s=-e.s,w(e)};g.plus=g.add=function(e){var t,r,n,i,o,s,a,c,u,l,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return!d.s||!e.s?e=new f(NaN):d.d||(e=new f(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(u=d.d,l=e.d,a=f.precision,c=f.rounding,!u[0]||!l[0])return l[0]||(e=new f(d)),x?w(e,a,c):e;if(o=j(d.e/P),n=j(e.e/P),u=u.slice(),i=o-n,i){for(i<0?(r=u,i=-i,s=l.length):(r=l,n=o,s=u.length),o=Math.ceil(a/P),s=o>s?o+1:s+1,i>s&&(i=s,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,r=l,l=u,u=r),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/ne|0,u[i]%=ne;for(t&&(u.unshift(t),++n),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Ze(u,n),x?w(e,a,c):e};g.precision=g.sd=function(e){var t,r=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(pe+e);return r.d?(t=hr(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t};g.round=function(){var e=this,t=e.constructor;return w(new t(e),e.e+1,t.rounding)};g.sine=g.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+P,n.rounding=1,r=bn(n,xr(n,r)),n.precision=e,n.rounding=t,w(ae>2?r.neg():r,e,t,!0)):new n(NaN)};g.squareRoot=g.sqrt=function(){var e,t,r,n,i,o,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(x=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=q(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=j((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),n=new l(t)):n=new l(u.toString()),r=(c=l.precision)+3;;)if(o=n,n=o.plus(F(s,o,r+2,1)).times(.5),q(o.d).slice(0,r)===(t=q(n.d)).slice(0,r))if(t=t.slice(r-3,r+1),t=="9999"||!i&&t=="4999"){if(!i&&(w(o,c+1,0),o.times(o).eq(s))){n=o;break}r+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(w(n,c+1,1),e=!n.times(n).eq(s));break}return x=!0,w(n,c,l.rounding,e)};g.tangent=g.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,r=r.sin(),r.s=1,r=F(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,w(ae==2||ae==4?r.neg():r,e,t,!0)):new n(NaN)};g.times=g.mul=function(e){var t,r,n,i,o,s,a,c,u,l=this,d=l.constructor,f=l.d,m=(e=new d(e)).d;if(e.s*=l.s,!f||!f[0]||!m||!m[0])return new d(!e.s||f&&!f[0]&&!m||m&&!m[0]&&!f?NaN:!f||!m?e.s/0:e.s*0);for(r=j(l.e/P)+j(e.e/P),c=f.length,u=m.length,c<u&&(o=f,f=m,m=o,s=c,c=u,u=s),o=[],s=c+u,n=s;n--;)o.push(0);for(n=u;--n>=0;){for(t=0,i=c+n;i>n;)a=o[i]+m[n]*f[i-n-1]+t,o[i--]=a%ne|0,t=a/ne|0;o[i]=(o[i]+t)%ne|0}for(;!o[--s];)o.pop();return t?++r:o.shift(),e.d=o,e.e=Ze(o,r),x?w(e,d.precision,d.rounding):e};g.toBinary=function(e,t){return Pt(this,2,e,t)};g.toDecimalPlaces=g.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(X(e,0,me),t===void 0?t=n.rounding:X(t,0,8),w(r,e+r.e+1,t))};g.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=oe(n,!0):(X(e,0,me),t===void 0?t=i.rounding:X(t,0,8),n=w(new i(n),e+1,t),r=oe(n,!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r};g.toFixed=function(e,t){var r,n,i=this,o=i.constructor;return e===void 0?r=oe(i):(X(e,0,me),t===void 0?t=o.rounding:X(t,0,8),n=w(new o(i),e+i.e+1,t),r=oe(n,!1,e+n.e+1)),i.isNeg()&&!i.isZero()?"-"+r:r};g.toFraction=function(e){var t,r,n,i,o,s,a,c,u,l,d,f,m=this,h=m.d,b=m.constructor;if(!h)return new b(m);if(u=r=new b(1),n=c=new b(0),t=new b(n),o=t.e=hr(h)-m.e-1,s=o%P,t.d[0]=M(10,s<0?P+s:s),e==null)e=o>0?t:u;else{if(a=new b(e),!a.isInt()||a.lt(u))throw Error(pe+a);e=a.gt(t)?o>0?t:u:a}for(x=!1,a=new b(q(h)),l=b.precision,b.precision=o=h.length*P*2;d=F(a,t,0,1,1),i=r.plus(d.times(n)),i.cmp(e)!=1;)r=n,n=i,i=u,u=c.plus(d.times(i)),c=i,i=t,t=a.minus(d.times(i)),a=i;return i=F(e.minus(r),n,0,1,1),c=c.plus(i.times(u)),r=r.plus(i.times(n)),c.s=u.s=m.s,f=F(u,n,o,1).minus(m).abs().cmp(F(c,r,o,1).minus(m).abs())<1?[u,n]:[c,r],b.precision=l,x=!0,f};g.toHexadecimal=g.toHex=function(e,t){return Pt(this,16,e,t)};g.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),e==null){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),t===void 0?t=n.rounding:X(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(x=!1,r=F(r,e,0,t,1).times(e),x=!0,w(r)):(e.s=r.s,r=e),r};g.toNumber=function(){return+this};g.toOctal=function(e,t){return Pt(this,8,e,t)};g.toPower=g.pow=function(e){var t,r,n,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(M(+a,u));if(a=new c(a),a.eq(1))return a;if(n=c.precision,o=c.rounding,e.eq(1))return w(a,n,o);if(t=j(e.e/P),t>=e.d.length-1&&(r=u<0?-u:u)<=pn)return i=wr(c,a,r,n),e.s<0?new c(1).div(i):w(i,n,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return r=M(+a,u),t=r==0||!isFinite(r)?j(u*(Math.log("0."+q(a.d))/Math.LN10+a.e+1)):new c(r+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(x=!1,c.rounding=a.s=1,r=Math.min(12,(t+"").length),i=ht(e.times(fe(a,n+r)),n),i.d&&(i=w(i,n+5,1),Fe(i.d,n,o)&&(t=n+10,i=w(ht(e.times(fe(a,t+r)),t),t+5,1),+q(i.d).slice(n+1,n+15)+1==1e14&&(i=w(i,n+1,0)))),i.s=s,x=!0,c.rounding=o,w(i,n,o))};g.toPrecision=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=oe(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(X(e,1,me),t===void 0?t=i.rounding:X(t,0,8),n=w(new i(n),e,t),r=oe(n,e<=n.e||n.e<=i.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r};g.toSignificantDigits=g.toSD=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(X(e,1,me),t===void 0?t=n.rounding:X(t,0,8)),w(new n(r),e,t)};g.toString=function(){var e=this,t=e.constructor,r=oe(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r};g.truncated=g.trunc=function(){return w(new this.constructor(this),this.e+1,1)};g.valueOf=g.toJSON=function(){var e=this,t=e.constructor,r=oe(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};function q(e){var t,r,n,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)n=e[t]+"",r=P-n.length,r&&(o+=de(r)),o+=n;s=e[t],n=s+"",r=P-n.length,r&&(o+=de(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function X(e,t,r){if(e!==~~e||e<t||e>r)throw Error(pe+e)}function Fe(e,t,r,n){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=P,i=0):(i=Math.ceil((t+1)/P),t%=P),o=M(10,P-t),a=e[i]%o|0,n==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=r<4&&a==99999||r>3&&a==49999||a==5e4||a==0):s=(r<4&&a+1==o||r>3&&a+1==o/2)&&(e[i+1]/o/100|0)==M(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(n||r<4)&&a==9999||!n&&r>3&&a==4999):s=((n||r<4)&&a+1==o||!n&&r>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==M(10,t-3)-1,s}function Ge(e,t,r){for(var n,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=gt.indexOf(e.charAt(s++)),n=0;n<i.length;n++)i[n]>r-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/r|0,i[n]%=r)}return i.reverse()}function gn(e,t){var r,n,i;if(t.isZero())return t;n=t.d.length,n<32?(r=Math.ceil(n/3),i=(1/Xe(4,r)).toString()):(r=16,i="2.3283064365386962890625e-10"),e.precision+=r,t=Be(e,1,t.times(i),new e(1));for(var o=r;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=r,t}var F=function(){function e(n,i,o){var s,a=0,c=n.length;for(n=n.slice();c--;)s=n[c]*i+a,n[c]=s%o|0,a=s/o|0;return a&&n.unshift(a),n}function t(n,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(n[a]!=i[a]){c=n[a]>i[a]?1:-1;break}return c}function r(n,i,o,s){for(var a=0;o--;)n[o]-=a,a=n[o]<i[o]?1:0,n[o]=a*s+n[o]-i[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,o,s,a,c){var u,l,d,f,m,h,b,T,k,v,B,_,le,Y,ge,Ne,Te,xe,$,Se,Oe=n.constructor,ot=n.s==i.s?1:-1,G=n.d,C=i.d;if(!G||!G[0]||!C||!C[0])return new Oe(!n.s||!i.s||(G?C&&G[0]==C[0]:!C)?NaN:G&&G[0]==0||!C?ot*0:ot/0);for(c?(m=1,l=n.e-i.e):(c=ne,m=P,l=j(n.e/m)-j(i.e/m)),$=C.length,Te=G.length,k=new Oe(ot),v=k.d=[],d=0;C[d]==(G[d]||0);d++);if(C[d]>(G[d]||0)&&l--,o==null?(Y=o=Oe.precision,s=Oe.rounding):a?Y=o+(n.e-i.e)+1:Y=o,Y<0)v.push(1),h=!0;else{if(Y=Y/m+2|0,d=0,$==1){for(f=0,C=C[0],Y++;(d<Te||f)&&Y--;d++)ge=f*c+(G[d]||0),v[d]=ge/C|0,f=ge%C|0;h=f||d<Te}else{for(f=c/(C[0]+1)|0,f>1&&(C=e(C,f,c),G=e(G,f,c),$=C.length,Te=G.length),Ne=$,B=G.slice(0,$),_=B.length;_<$;)B[_++]=0;Se=C.slice(),Se.unshift(0),xe=C[0],C[1]>=c/2&&++xe;do f=0,u=t(C,B,$,_),u<0?(le=B[0],$!=_&&(le=le*c+(B[1]||0)),f=le/xe|0,f>1?(f>=c&&(f=c-1),b=e(C,f,c),T=b.length,_=B.length,u=t(b,B,T,_),u==1&&(f--,r(b,$<T?Se:C,T,c))):(f==0&&(u=f=1),b=C.slice()),T=b.length,T<_&&b.unshift(0),r(B,b,_,c),u==-1&&(_=B.length,u=t(C,B,$,_),u<1&&(f++,r(B,$<_?Se:C,_,c))),_=B.length):u===0&&(f++,B=[0]),v[d++]=f,u&&B[0]?B[_++]=G[Ne]||0:(B=[G[Ne]],_=1);while((Ne++<Te||B[0]!==void 0)&&Y--);h=B[0]!==void 0}v[0]||v.shift()}if(m==1)k.e=l,pr=h;else{for(d=1,f=v[0];f>=10;f/=10)d++;k.e=d+l*m-1,w(k,a?o+k.e+1:o,s,h)}return k}}();function w(e,t,r,n){var i,o,s,a,c,u,l,d,f,m=e.constructor;e:if(t!=null){if(d=e.d,!d)return e;for(i=1,a=d[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=P,s=t,l=d[f=0],c=l/M(10,i-s-1)%10|0;else if(f=Math.ceil((o+1)/P),a=d.length,f>=a)if(n){for(;a++<=f;)d.push(0);l=c=0,i=1,o%=P,s=o-P+1}else break e;else{for(l=a=d[f],i=1;a>=10;a/=10)i++;o%=P,s=o-P+i,c=s<0?0:l/M(10,i-s-1)%10|0}if(n=n||t<0||d[f+1]!==void 0||(s<0?l:l%M(10,i-s-1)),u=r<4?(c||n)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||n||r==6&&(o>0?s>0?l/M(10,i-s):0:d[f-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,u?(t-=e.e+1,d[0]=M(10,(P-t%P)%P),e.e=-t||0):d[0]=e.e=0,e;if(o==0?(d.length=f,a=1,f--):(d.length=f+1,a=M(10,P-o),d[f]=s>0?(l/M(10,i-s)%M(10,s)|0)*a:0),u)for(;;)if(f==0){for(o=1,s=d[0];s>=10;s/=10)o++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,d[0]==ne&&(d[0]=1));break}else{if(d[f]+=a,d[f]!=ne)break;d[f--]=0,a=1}for(o=d.length;d[--o]===0;)d.pop()}return x&&(e.e>m.maxE?(e.d=null,e.e=NaN):e.e<m.minE&&(e.e=0,e.d=[0])),e}function oe(e,t,r){if(!e.isFinite())return Tr(e);var n,i=e.e,o=q(e.d),s=o.length;return t?(r&&(n=r-s)>0?o=o.charAt(0)+"."+o.slice(1)+de(n):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+de(-i-1)+o,r&&(n=r-s)>0&&(o+=de(n))):i>=s?(o+=de(i+1-s),r&&(n=r-i-1)>0&&(o=o+"."+de(n))):((n=i+1)<s&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(o+="."),o+=de(n))),o}function Ze(e,t){var r=e[0];for(t*=P;r>=10;r/=10)t++;return t}function He(e,t,r){if(t>mn)throw x=!0,r&&(e.precision=r),Error(mr);return w(new e(je),t,1,!0)}function re(e,t,r){if(t>bt)throw Error(mr);return w(new e(Ye),t,r,!0)}function hr(e){var t=e.length-1,r=t*P+1;if(t=e[t],t){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function de(e){for(var t="";e--;)t+="0";return t}function wr(e,t,r,n){var i,o=new e(1),s=Math.ceil(n/P+4);for(x=!1;;){if(r%2&&(o=o.times(t),dr(o.d,s)&&(i=!0)),r=j(r/2),r===0){r=o.d.length-1,i&&o.d[r]===0&&++o.d[r];break}t=t.times(t),dr(t.d,s)}return x=!0,o}function lr(e){return e.d[e.d.length-1]&1}function Pr(e,t,r){for(var n,i=new e(t[0]),o=0;++o<t.length;)if(n=new e(t[o]),n.s)i[r](n)&&(i=n);else{i=n;break}return i}function ht(e,t){var r,n,i,o,s,a,c,u=0,l=0,d=0,f=e.constructor,m=f.rounding,h=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(x=!1,c=h):c=t,a=new f(.03125);e.e>-2;)e=e.times(a),d+=5;for(n=Math.log(M(2,d))/Math.LN10*2+5|0,c+=n,r=o=s=new f(1),f.precision=c;;){if(o=w(o.times(e),c,1),r=r.times(++l),a=s.plus(F(o,r,c,1)),q(a.d).slice(0,c)===q(s.d).slice(0,c)){for(i=d;i--;)s=w(s.times(s),c,1);if(t==null)if(u<3&&Fe(s.d,c-n,m,u))f.precision=c+=10,r=o=a=new f(1),l=0,u++;else return w(s,f.precision=h,m,x=!0);else return f.precision=h,s}s=a}}function fe(e,t){var r,n,i,o,s,a,c,u,l,d,f,m=1,h=10,b=e,T=b.d,k=b.constructor,v=k.rounding,B=k.precision;if(b.s<0||!T||!T[0]||!b.e&&T[0]==1&&T.length==1)return new k(T&&!T[0]?-1/0:b.s!=1?NaN:T?0:b);if(t==null?(x=!1,l=B):l=t,k.precision=l+=h,r=q(T),n=r.charAt(0),Math.abs(o=b.e)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)b=b.times(e),r=q(b.d),n=r.charAt(0),m++;o=b.e,n>1?(b=new k("0."+r),o++):b=new k(n+"."+r.slice(1))}else return u=He(k,l+2,B).times(o+""),b=fe(new k(n+"."+r.slice(1)),l-h).plus(u),k.precision=B,t==null?w(b,B,v,x=!0):b;for(d=b,c=s=b=F(b.minus(1),b.plus(1),l,1),f=w(b.times(b),l,1),i=3;;){if(s=w(s.times(f),l,1),u=c.plus(F(s,new k(i),l,1)),q(u.d).slice(0,l)===q(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(He(k,l+2,B).times(o+""))),c=F(c,new k(m),l,1),t==null)if(Fe(c.d,l-h,v,a))k.precision=l+=h,u=s=b=F(d.minus(1),d.plus(1),l,1),f=w(b.times(b),l,1),i=a=1;else return w(c,k.precision=B,v,x=!0);else return k.precision=B,c;c=u,i+=2}}function Tr(e){return String(e.s*e.s/0)}function wt(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;n++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(n,i),t){if(i-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%P,r<0&&(n+=P),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=P;n<i;)e.d.push(+t.slice(n,n+=P));t=t.slice(n),n=P-t.length}else n-=i;for(;n--;)t+="0";e.d.push(+t),x&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function yn(e,t){var r,n,i,o,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),br.test(t))return wt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(dn.test(t))r=16,t=t.toLowerCase();else if(ln.test(t))r=2;else if(fn.test(t))r=8;else throw Error(pe+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,n=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=wr(n,new n(r),o,o*2)),u=Ge(t,r,ne),l=u.length-1,o=l;u[o]===0;--o)u.pop();return o<0?new n(e.s*0):(e.e=Ze(u,l),e.d=u,x=!1,s&&(e=F(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?M(2,c):Je.pow(2,c))),x=!0,e)}function bn(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:Be(e,2,t,t);r=1.4*Math.sqrt(n),r=r>16?16:r|0,t=t.times(1/Xe(5,r)),t=Be(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);r--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function Be(e,t,r,n,i){var o,s,a,c,u=1,l=e.precision,d=Math.ceil(l/P);for(x=!1,c=r.times(r),a=new e(n);;){if(s=F(a.times(c),new e(t++*t++),l,1),a=i?n.plus(s):n.minus(s),n=F(s.times(c),new e(t++*t++),l,1),s=a.plus(n),s.d[d]!==void 0){for(o=d;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=n,n=s,s=o,u++}return x=!0,s.d.length=d+1,s}function Xe(e,t){for(var r=e;--t;)r*=e;return r}function xr(e,t){var r,n=t.s<0,i=re(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return ae=n?4:1,t;if(r=t.divToInt(i),r.isZero())ae=n?3:2;else{if(t=t.minus(r.times(i)),t.lte(o))return ae=lr(r)?n?2:3:n?4:1,t;ae=lr(r)?n?1:4:n?3:2}return t.minus(i).abs()}function Pt(e,t,r,n){var i,o,s,a,c,u,l,d,f,m=e.constructor,h=r!==void 0;if(h?(X(r,1,me),n===void 0?n=m.rounding:X(n,0,8)):(r=m.precision,n=m.rounding),!e.isFinite())l=Tr(e);else{for(l=oe(e),s=l.indexOf("."),h?(i=2,t==16?r=r*4-3:t==8&&(r=r*3-2)):i=t,s>=0&&(l=l.replace(".",""),f=new m(1),f.e=l.length-s,f.d=Ge(oe(f),10,i),f.e=f.d.length),d=Ge(l,10,i),o=c=d.length;d[--c]==0;)d.pop();if(!d[0])l=h?"0p+0":"0";else{if(s<0?o--:(e=new m(e),e.d=d,e.e=o,e=F(e,f,r,n,0,i),d=e.d,o=e.e,u=pr),s=d[r],a=i/2,u=u||d[r+1]!==void 0,u=n<4?(s!==void 0||u)&&(n===0||n===(e.s<0?3:2)):s>a||s===a&&(n===4||u||n===6&&d[r-1]&1||n===(e.s<0?8:7)),d.length=r,u)for(;++d[--r]>i-1;)d[r]=0,r||(++o,d.unshift(1));for(c=d.length;!d[c-1];--c);for(s=0,l="";s<c;s++)l+=gt.charAt(d[s]);if(h){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(d=Ge(l,i,t),c=d.length;!d[c-1];--c);for(s=1,l="1.";s<c;s++)l+=gt.charAt(d[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function dr(e,t){if(e.length>t)return e.length=t,!0}function hn(e){return new this(e).abs()}function wn(e){return new this(e).acos()}function Pn(e){return new this(e).acosh()}function Tn(e,t){return new this(e).plus(t)}function xn(e){return new this(e).asin()}function Sn(e){return new this(e).asinh()}function kn(e){return new this(e).atan()}function An(e){return new this(e).atanh()}function Ln(e,t){e=new this(e),t=new this(t);var r,n=this.precision,i=this.rounding,o=n+4;return!e.s||!t.s?r=new this(NaN):!e.d&&!t.d?(r=re(this,o,1).times(t.s>0?.25:.75),r.s=e.s):!t.d||e.isZero()?(r=t.s<0?re(this,n,i):new this(0),r.s=e.s):!e.d||t.isZero()?(r=re(this,o,1).times(.5),r.s=e.s):t.s<0?(this.precision=o,this.rounding=1,r=this.atan(F(e,t,o,1)),t=re(this,o,1),this.precision=n,this.rounding=i,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(F(e,t,o,1)),r}function In(e){return new this(e).cbrt()}function Bn(e){return w(e=new this(e),e.e+1,2)}function Rn(e,t,r){return new this(e).clamp(t,r)}function Nn(e){if(!e||typeof e!="object")throw Error(ze+"Object expected");var t,r,n,i=e.defaults===!0,o=["precision",1,me,"rounding",0,8,"toExpNeg",-Ie,0,"toExpPos",0,Ie,"maxE",0,Ie,"minE",-Ie,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(r=o[t],i&&(this[r]=yt[r]),(n=e[r])!==void 0)if(j(n)===n&&n>=o[t+1]&&n<=o[t+2])this[r]=n;else throw Error(pe+r+": "+n);if(r="crypto",i&&(this[r]=yt[r]),(n=e[r])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(gr);else this[r]=!1;else throw Error(pe+r+": "+n);return this}function Kn(e){return new this(e).cos()}function Vn(e){return new this(e).cosh()}function Sr(e){var t,r,n;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,fr(o)){u.s=o.s,x?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;x?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return wt(u,o.toString())}else if(c!=="string")throw Error(pe+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),br.test(o)?wt(u,o):yn(u,o)}if(i.prototype=g,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Nn,i.clone=Sr,i.isDecimal=fr,i.abs=hn,i.acos=wn,i.acosh=Pn,i.add=Tn,i.asin=xn,i.asinh=Sn,i.atan=kn,i.atanh=An,i.atan2=Ln,i.cbrt=In,i.ceil=Bn,i.clamp=Rn,i.cos=Kn,i.cosh=Vn,i.div=Fn,i.exp=vn,i.floor=Cn,i.hypot=Dn,i.ln=En,i.log=_n,i.log10=Mn,i.log2=Wn,i.max=On,i.min=Un,i.mod=qn,i.mul=Gn,i.pow=jn,i.random=Yn,i.round=Hn,i.sign=zn,i.sin=Zn,i.sinh=Xn,i.sqrt=Jn,i.sub=Qn,i.sum=$n,i.tan=ei,i.tanh=ti,i.trunc=ri,e===void 0&&(e={}),e&&e.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function Fn(e,t){return new this(e).div(t)}function vn(e){return new this(e).exp()}function Cn(e){return w(e=new this(e),e.e+1,3)}function Dn(){var e,t,r=new this(0);for(x=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return x=!0,new this(1/0);r=t}return x=!0,r.sqrt()}function fr(e){return e instanceof Je||e&&e.toStringTag===yr||!1}function En(e){return new this(e).ln()}function _n(e,t){return new this(e).log(t)}function Wn(e){return new this(e).log(2)}function Mn(e){return new this(e).log(10)}function On(){return Pr(this,arguments,"lt")}function Un(){return Pr(this,arguments,"gt")}function qn(e,t){return new this(e).mod(t)}function Gn(e,t){return new this(e).mul(t)}function jn(e,t){return new this(e).pow(t)}function Yn(e){var t,r,n,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:X(e,1,me),n=Math.ceil(e/P),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));o<n;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(n*=4);o<n;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=n/4}else throw Error(gr);else for(;o<n;)a[o++]=Math.random()*1e7|0;for(n=a[--o],e%=P,n&&e&&(i=M(10,P-e),a[o]=(n/i|0)*i);a[o]===0;o--)a.pop();if(o<0)r=0,a=[0];else{for(r=-1;a[0]===0;r-=P)a.shift();for(n=1,i=a[0];i>=10;i/=10)n++;n<P&&(r-=P-n)}return s.e=r,s.d=a,s}function Hn(e){return w(e=new this(e),e.e+1,this.rounding)}function zn(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Zn(e){return new this(e).sin()}function Xn(e){return new this(e).sinh()}function Jn(e){return new this(e).sqrt()}function Qn(e,t){return new this(e).sub(t)}function $n(){var e=0,t=arguments,r=new this(t[e]);for(x=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return x=!0,w(r,this.precision,this.rounding)}function ei(e){return new this(e).tan()}function ti(e){return new this(e).tanh()}function ri(e){return w(e=new this(e),e.e+1,1)}g[Symbol.for("nodejs.util.inspect.custom")]=g.toString;g[Symbol.toStringTag]="Decimal";var Je=g.constructor=Sr(yt);je=new Je(je);Ye=new Je(Ye);import{PublicKey as kt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as ni}from"@solana/spl-token";import{PublicKey as E,SystemProgram as ii,SYSVAR_RENT_PUBKEY as oi}from"@solana/web3.js";function p({pubkey:e,isSigner:t=!1,isWritable:r=!0}){return{pubkey:e,isWritable:r,isSigner:t}}var Tt=[p({pubkey:ni,isWritable:!1}),p({pubkey:ii.programId,isWritable:!1}),p({pubkey:oi,isWritable:!1})];function Ar({publicKey:e,transformSol:t}){let r=xt(e.toString());if(r instanceof E)return t&&r.equals(be)?kr:r;if(t&&r.toString()===be.toBase58())return kr;if(typeof r=="string"){if(r===E.default.toBase58())return E.default;try{return new E(r)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function xt(e){try{return new E(e)}catch{return e}}var Ns=new E("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),St=new E("SysvarRent111111111111111111111111111111111"),Ks=new E("SysvarC1ock11111111111111111111111111111111"),Vs=new E("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Qe=new E("Sysvar1nstructions1111111111111111111111111"),Fs=new E("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),vs=new E("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Cs=new E("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Ds=new E("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Es=new E("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),_s=new E("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Ws=new E("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Ms=new E("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Os=new E("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Us=new E("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),qs=new E("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),kr=new E("So11111111111111111111111111111111111111112"),be=E.default;import{PublicKey as si}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Lr}from"@solana/spl-token";var Ir={chainId:101,address:si.default.toBase58(),programId:Lr.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},he={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Lr.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var At=class{constructor({mint:t,decimals:r,symbol:n,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===be.toBase58()||t instanceof kt&&be.equals(t)){this.decimals=he.decimals,this.symbol=he.symbol,this.name=he.name,this.mint=new kt(he.address),this.isToken2022=!1;return}this.decimals=r,this.symbol=n||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?kt.default:Ar({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},we=At;we.WSOL=new At(z(U({},he),{mint:he.address}));import et from"big.js";import ci from"bn.js";import li from"decimal.js-light";import ai from"toformat";var ui=ai,ve=ui;var $e=W("module/fraction"),Lt=ve(et),Ce=ve(li),di={[0]:Ce.ROUND_DOWN,[1]:Ce.ROUND_HALF_UP,[2]:Ce.ROUND_UP},fi={[0]:et.roundDown,[1]:et.roundHalfUp,[2]:et.roundUp},K=class{constructor(t,r=new ci(1)){this.numerator=R(t),this.denominator=R(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new K(this.denominator,this.numerator)}add(t){let r=t instanceof K?t:new K(R(t));return this.denominator.eq(r.denominator)?new K(this.numerator.add(r.numerator),this.denominator):new K(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(t){let r=t instanceof K?t:new K(R(t));return this.denominator.eq(r.denominator)?new K(this.numerator.sub(r.numerator),this.denominator):new K(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(t){let r=t instanceof K?t:new K(R(t));return new K(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(t){let r=t instanceof K?t:new K(R(t));return new K(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(t,r={groupSeparator:""},n=1){Number.isInteger(t)||$e.logWithError(`${t} is not an integer.`),t<=0&&$e.logWithError(`${t} is not positive.`),Ce.set({precision:t+1,rounding:di[n]});let i=new Ce(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),r)}toFixed(t,r={groupSeparator:""},n=1){return Number.isInteger(t)||$e.logWithError(`${t} is not an integer.`),t<0&&$e.logWithError(`${t} is negative.`),Lt.DP=t,Lt.RM=fi[n]||1,new Lt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,r)}isZero(){return this.numerator.isZero()}};var mi=W("Raydium_price"),ue=class extends K{constructor(r){let{baseToken:n,quoteToken:i,numerator:o,denominator:s}=r;super(o,s);this.baseToken=n,this.quoteToken=i,this.scalar=new K(It(n.decimals),It(i.decimals))}get raw(){return new K(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new ue({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(r){this.quoteToken!==r.baseToken&&mi.logWithError("mul token not equals");let n=super.mul(r);return new ue({baseToken:this.baseToken,quoteToken:r.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(r=this.quoteToken.decimals,n,i){return this.adjusted.toSignificant(r,n,i)}toFixed(r=this.quoteToken.decimals,n,i){return this.adjusted.toFixed(r,n,i)}};var Bt=class{constructor({decimals:t,symbol:r="UNKNOWN",name:n="UNKNOWN"}){this.decimals=t,this.symbol=r,this.name=n}equals(t){return this===t}},tt=Bt;tt.SOL=new Bt(Ir);import gi from"bn.js";var Br=new K(new gi(100)),Re=class extends K{toSignificant(t=5,r,n){return this.mul(Br).toSignificant(t,r,n)}toFixed(t=2,r,n){return this.mul(Br).toFixed(t,r,n)}};var yi=new J(0),Ma=new J(1),Oa=new J(2),Ua=new J(3),qa=new J(5),Rt=new J(10),Ga=new J(100),ja=new J(1e3),Ya=new J(1e4),Rr=9007199254740991;function R(e){let t=W("Raydium_parseBigNumberish");if(e instanceof J)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new J(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Rr||e<=-Rr)&&t.logWithError(`BigNumberish number overflow: ${e}`),new J(String(e))):typeof e=="bigint"?new J(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new J(0))}function It(e){return Rt.pow(R(e))}var hi=W("Raydium_amount"),Kr=ve(bi);function wi(e,t){let r="0",n="0";if(e.includes(".")){let i=e.split(".");i.length===2?([r,n]=i,n=n.padEnd(t,"0")):hi.logWithError(`invalid number string, num: ${e}`)}else r=e;return[r,n.slice(0,t)||n]}var ce=class extends K{constructor(r,n,i=!0,o){let s=new rt(0),a=Rt.pow(new rt(r.decimals));if(i)s=R(n);else{let c=new rt(0),u=new rt(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[l,d]=wi(n.toString(),r.decimals);c=R(l),u=R(d)}c=c.mul(a),s=c.add(u)}super(s,a);this.logger=W(o||"TokenAmount"),this.token=r}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(r){return this.token.equals(r.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(r.raw)}lt(r){return this.token.equals(r.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(r.raw)}add(r){return this.token.equals(r.token)||this.logger.logWithError("add token not equals"),new ce(this.token,this.raw.add(r.raw))}subtract(r){return this.token.equals(r.token)||this.logger.logWithError("sub token not equals"),new ce(this.token,this.raw.sub(r.raw))}toSignificant(r=this.token.decimals,n,i=0){return super.toSignificant(r,n,i)}toFixed(r=this.token.decimals,n,i=0){return r>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(r,n,i)}toExact(r={groupSeparator:""}){return Kr.DP=this.token.decimals,new Kr(this.numerator.toString()).div(this.denominator.toString()).toFormat(r)}};function Nr(e){return typeof e=="object"&&e!==null&&![we,ce,Pi,K,Ti,ue,Re].some(t=>typeof t=="object"&&e instanceof t)}function nt(e){return typeof e=="string"?xt(e):Array.isArray(e)?e.map(t=>nt(t)):Nr(e)?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,nt(r)])):e}import{PublicKey as Zu,sendAndConfirmTransaction as Xu,Transaction as Qu,TransactionMessage as ec,VersionedTransaction as tc}from"@solana/web3.js";import nc from"axios";var De={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw"};import{PublicKey as xi,ComputeBudgetProgram as Tu,Transaction as Su,TransactionMessage as Au,Keypair as Lu,VersionedTransaction as Bu}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Nu}from"@solana/spl-token";var Fu=W("Raydium_txUtil");function ee(e,t){let[r,n]=xi.findProgramAddressSync(e,t);return{publicKey:r,nonce:n}}import{PublicKey as Si,AddressLookupTableAccount as Vr}from"@solana/web3.js";var ki={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new Vr({key:new Si("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:Vr.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};function Nt(e,t=1,r=[]){let n=[...e];if(t<=0)return r;for(;n.length;)r.push(n.splice(0,t));return r}var vr=e=>typeof e=="number";function Cr(e,t,r){let n=vr(t)?t*((r==null?void 0:r.unit)==="s"?1e3:1):t;return new Date(e).getTime()<=n}function Dr(e,t,r){let n=vr(t)?t*((r==null?void 0:r.unit)==="s"?1e3:1):t;return new Date(e).getTime()>n}import{PublicKey as Ai}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Li}from"@solana/spl-token";function Ee(e,t,r){return ee([e.toBuffer(),(r!=null?r:Li).toBuffer(),t.toBuffer()],new Ai("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import bc from"bn.js";var Kt=W("Raydium_accountInfo_util");async function Fr(e,t,r){let{batchRequest:n,commitment:i="confirmed"}=U({batchRequest:!1},r),o=Nt(t,100),s=new Array(o.length).fill([]);if(n){let a=o.map(l=>{let d=e._buildArgs([l.map(f=>f.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:d}}),c=Nt(a,10);s=(await(await Promise.all(c.map(async l=>await e._rpcBatchRequest(l)))).flat()).map(l=>(l.error&&Kt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.error.message}`),l.result.value.map(d=>{if(d){let{data:f,executable:m,lamports:h,owner:b,rentEpoch:T}=d;return f.length!==2&&f[1]!=="base64"&&Kt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(f[0],"base64"),executable:m,lamports:h,owner:new Ii(b),rentEpoch:T}}return null})))}else try{s=await Promise.all(o.map(a=>e.getMultipleAccountsInfo(a,i)))}catch(a){a instanceof Error&&Kt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${a.message}`)}return s.flat()}async function Er(e,t,r){let n=await Fr(e,t.map(i=>i.pubkey),r);return t.map((i,o)=>z(U({},i),{accountInfo:n[o]}))}var Vt=N([A("mint"),A("owner"),y("amount"),Ae("delegateOption"),A("delegate"),V("state"),Ae("isNativeOption"),y("isNative"),y("delegatedAmount"),Ae("closeAuthorityOption"),A("closeAuthority")]);var _e=W("Raydium.farm.util");function al({programId:e,poolId:t,mint:r,type:n}){let{publicKey:i}=ee([t.toBuffer(),r.toBuffer(),Buffer.from(n==="lpVault"?"lp_vault_associated_seed":n==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],e);return i}function ie({programId:e,poolId:t,owner:r,version:n}){let{publicKey:i}=ee([t.toBuffer(),r.toBuffer(),Buffer.from(n===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],e);return i}var ul=({programId:e,poolId:t})=>ee([t.toBuffer()],e);function cl(e){return{isSet:new Q(1),rewardPerSecond:R(e.perSecond),rewardOpenTime:R(e.openTime),rewardEndTime:R(e.endTime),rewardType:R(Le[e.rewardType])}}function ll(e){return R(e.endTime).sub(R(e.openTime)).mul(R(e.perSecond))}function Bi(e){let t=rr[e];return t||_e.logWithError("invalid version",e),t}function Ri(e){let t=tr[e];return t||_e.logWithError("invalid version",e),t}function Ni(e,t,r,n){if(e.version===3||e.version===5){if(e.lastSlot.gte(new Q(r)))return e;let i=new Q(r).sub(e.lastSlot);e.lastSlot=new Q(r);for(let o of e.rewardInfos){if(t.amount.eq(new Q(0)))continue;let s=o.perSlotReward.mul(i);o.perShareReward=o.perShareReward.add(s.mul(new Q(10).pow(new Q(e.version===3?9:15))).div(t.amount)),o.totalReward=o.totalReward.add(s)}}else if(e.version===6)for(let i of e.rewardInfos){if(i.rewardState.eq(new Q(0)))continue;let o=Q.min(new Q(n),i.rewardEndTime);if(i.rewardOpenTime.gte(o))continue;let a=o.sub(i.rewardLastUpdateTime).mul(i.rewardPerSecond),c=i.totalReward.sub(i.totalRewardEmissioned);c.lt(a)?(a=c,i.rewardLastUpdateTime=i.rewardLastUpdateTime.add(c.div(i.rewardPerSecond))):i.rewardLastUpdateTime=o,!t.amount.eq(new Q(0))&&(i.accRewardPerShare=i.accRewardPerShare.add(a.mul(e.rewardMultiplier).div(t.amount)),i.totalRewardEmissioned=i.totalRewardEmissioned.add(a))}return e}async function dl({connection:e,farmPools:t,owner:r,config:n,chainTime:i}){let o=!1,s=!1,a=new Q(10),c=[];for(let f of t){let m=nt(f);m.version===6?s=!0:o=!0,c.push({pubkey:m.id,version:m.version,key:"state",poolId:m.id},{pubkey:m.lpVault,version:m.version,key:"lpVault",poolId:m.id}),r&&c.push({pubkey:ie({programId:m.programId,poolId:m.id,owner:r,version:f.version}),version:m.version,key:"ledger",poolId:m.id})}let u={},l=await Er(e,c,n);for(let{pubkey:f,version:m,key:h,poolId:b,accountInfo:T}of l){let k=b.toBase58();if(u[k]=U({},u[k]),h==="state"){let v=Ri(m);(!T||!T.data||T.data.length!==v.span)&&_e.logWithError(`invalid farm state account info, pools.id, ${f}`),u[k].state=v.decode(T.data)}else if(h==="lpVault")(!T||!T.data||T.data.length!==Vt.span)&&_e.logWithError(`invalid farm lp vault account info, pools.lpVault, ${f}`),u[k].lpVault=Vt.decode(T.data);else if(h==="ledger"){let v=Bi(m);T&&T.data&&(T.data.length!==v.span&&_e.logWithError(`invalid farm ledger account info, ledger, ${f}`),u[k].ledger=v.decode(T.data))}}let d=s||o?await e.getSlot():0;for(let f of Object.keys(u))u[f]!==void 0&&(u[f].state=Ni(u[f].state,u[f].lpVault,d,i));for(let[f,{state:m,ledger:h}]of Object.entries(u))if(h){let b=m.version===6?m.rewardMultiplier:m.rewardInfos.length===1?a.pow(new Q(9)):a.pow(new Q(15)),T=m.rewardInfos.map((k,v)=>{let B=h.rewardDebts[v];return h.deposited.mul(m.version===6?k.accRewardPerShare:k.perShareReward).div(b).sub(B)});u[f].wrapped=z(U({},u[f].wrapped),{pendingRewards:T})}return u}function fl(e,t=Date.now()){if(e.version===6){let r=e.state.rewardInfos;if(r.every(({rewardOpenTime:n})=>Cr(t,n.toNumber(),{unit:"s"})))return"upcoming pool";if(r.every(({rewardEndTime:n})=>Dr(t,n.toNumber(),{unit:"s"})))return"closed pool"}else{let r=e.state.rewardInfos.map(({perSlotReward:n})=>n);if(r.length===2){if(String(r[0])==="0"&&String(r[1])!=="0")return"normal fusion pool";if(String(r[0])!=="0"&&String(r[1])!=="0")return"dual fusion pool";if(String(r[0])==="0"&&String(r[1])==="0")return"closed pool"}else if(r.length===1&&String(r[0])==="0")return"closed pool"}}async function Ft(e,t,r,n){let i=await e.getAccountInfo(t);if(i===null)throw Error("registrar info check error");let s=ur.decode(i.data).votingMints.findIndex(l=>l.mint.equals(n));if(s===-1)throw Error("find voter mint error");let a=await e.getAccountInfo(r);if(a===null)return{index:s,isInit:!1};let u=cr.decode(a.data).deposits.findIndex(l=>l.isUsed&&l.votingMintConfigIdx===s);return u===-1?{index:s,isInit:!1}:{index:u,isInit:!0}}import{PublicKey as S,SystemProgram as Pe,SYSVAR_RENT_PUBKEY as Ki,SYSVAR_CLOCK_PUBKEY as We,TransactionInstruction as O}from"@solana/web3.js";import{createAssociatedTokenAccountInstruction as Vi,TOKEN_PROGRAM_ID as te,ASSOCIATED_TOKEN_PROGRAM_ID as Fi}from"@solana/spl-token";import it from"bn.js";function vt(e,t,r){return ee([t.toBuffer(),Buffer.from("registrar","utf8"),r.toBuffer()],e)}function Ct(e,t){return ee([t.toBuffer(),Buffer.from("voting_mint_seed","utf8")],e)}function Dt(e,t){return ee([t.toBuffer()],e)}function Et(e,t,r){return ee([t.toBuffer(),Buffer.from("voter","utf8"),r.toBuffer()],e)}function _t(e,t,r){return ee([t.toBuffer(),Buffer.from("voter-weight-record","utf8"),r.toBuffer()],e)}function Wt(e,t,r,n){return ee([Buffer.from("governance","utf8"),t.toBuffer(),r.toBuffer(),n.toBuffer()],e)}var vi=W("Raydium_farm_instruction"),Me={voterStakeRegistryCreateVoter:Buffer.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:Buffer.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:Buffer.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:Buffer.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:Buffer.from([45,185,3,36,109,190,115,169])};function Kl(e){let{version:t,id:r,ledger:n,programId:i,owner:o}=e,s={3:9,5:10}[t];s||vi.logWithError(`invalid farm pool version: ${t}`);let a=Buffer.alloc(lt.span);lt.encode({instruction:s},a);let c=[p({pubkey:r}),p({pubkey:n}),p({pubkey:o,isWritable:!1}),p({pubkey:Pe.programId,isWritable:!1}),p({pubkey:Ki,isWritable:!1})];return{instruction:new O({programId:i,keys:c,data:a}),instructionType:De.FarmV3CreateLedger}}function Vl(e){var n;let t=Buffer.alloc(ft.span);ft.encode({instruction:0,nonce:new it(e.nonce),rewardTimeInfo:e.rewardInfoConfig},t);let r=[...Tt,p({pubkey:e.farmId}),p({pubkey:e.farmAuthority,isWritable:!1}),p({pubkey:e.lpVault}),p({pubkey:e.lpMint,isWritable:!1}),p({pubkey:e.lockVault}),p({pubkey:e.lockMint,isWritable:!1}),p({pubkey:(n=e.lockUserAccount)!=null?n:be}),p({pubkey:e.owner,isWritable:!1,isSigner:!0})];for(let i of e.rewardInfo)r.push(p({pubkey:i.rewardMint,isWritable:!1}),p({pubkey:i.rewardVault}),p({pubkey:i.userRewardToken}));return{instruction:new O({programId:e.programId,keys:r,data:t}),instructionType:De.FarmV6Create}}function Fl(e){let t=Buffer.alloc(dt.span);dt.encode({instruction:5},t);let r=[p({pubkey:te,isWritable:!1}),p({pubkey:e.id}),p({pubkey:e.authority,isWritable:!1}),p({pubkey:e.lpVault,isWritable:!1}),p({pubkey:e.rewardVault}),p({pubkey:e.userRewardToken}),p({pubkey:e.owner,isWritable:!1,isSigner:!0})];return{instruction:new O({programId:e.programId,keys:r,data:t}),instructionType:De.FarmV6CreatorWithdraw}}function Ci(e,t,r,n,i,o,s,a,c,u,l,d,f){let m=N([V("depositEntryIndex"),y("amount")]),h=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:te,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:Qe,isSigner:!1,isWritable:!1}],b=Buffer.alloc(m.span);m.encode({depositEntryIndex:d,amount:f},b);let T=Buffer.from([...Me.voterStakeRegistryDeposit,...b]);return new O({keys:h,programId:e,data:T})}function Di(e,t,r,n){let i=N([]),o=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:Pe.programId,isSigner:!1,isWritable:!1}],s=Buffer.alloc(i.span);i.encode({},s);let a=Buffer.from([...Me.voterStakeRegistryUpdateVoterWeightRecord,...s]);return new O({keys:o,programId:e,data:a})}function Ei(e,t,r,n,i,o,s,a,c,u,l,d,f,m,h){let b=N([V("depositEntryIndex"),y("amount")]),T=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:te,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:Qe,isSigner:!1,isWritable:!1}],k=Buffer.alloc(b.span);b.encode({depositEntryIndex:m,amount:h},k);let v=Buffer.from([...Me.voterStakeRegistryWithdraw,...k]);return new O({keys:T,programId:e,data:v})}function _i(e,t,r,n,i,o){let s=N([V("ins")]),a=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:Pe.programId,isSigner:!1,isWritable:!1}],c=Buffer.alloc(s.span);return s.encode({ins:23},c),new O({keys:a,programId:e,data:c})}function Wi(e,t,r,n,i,o,s,a){let c=N([V("voterBump"),V("voterWeightRecordBump")]),u=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:Pe.programId,isSigner:!1,isWritable:!1},{pubkey:St,isSigner:!1,isWritable:!1},{pubkey:Qe,isSigner:!1,isWritable:!1}],l=Buffer.alloc(c.span);c.encode({voterBump:s,voterWeightRecordBump:a},l);let d=Buffer.from([...Me.voterStakeRegistryCreateVoter,...l]);return new O({keys:u,programId:e,data:d})}function Mi(e,t,r,n,i,o,s,a,c,u,l,d){let f=N([V("depositEntryIndex"),V("kind"),V("option"),y("startTs"),Ae("periods"),Ke("allowClawback")]),m=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:Pe.programId,isSigner:!1,isWritable:!1},{pubkey:te,isSigner:!1,isWritable:!1},{pubkey:Fi,isSigner:!1,isWritable:!1},{pubkey:St,isSigner:!1,isWritable:!1}],h=Buffer.alloc(f.span);f.encode({depositEntryIndex:a,kind:c,option:u===void 0?0:1,startTs:u,periods:l,allowClawback:d},h);let b=Buffer.from([...Me.voterStakeRegistryCreateDepositEntry,...h]);return new O({keys:m,programId:e,data:b})}async function vl({connection:e,programId:t,governanceProgramId:r,voteWeightAddinProgramId:n,realm:i,communityTokenMint:o,owner:s,poolId:a,tokenProgram:c}){let u=vt(n,i,o).publicKey,l=ie({programId:t,poolId:a,owner:s,version:3}),d=await e.getAccountInfo(l);if(d===null)throw Error("user is not staker");let f=Ve.decode(d.data),m=f.deposited.sub(f.voteLockedBalance);if(console.log("amount",m.toString()),m.eq(new it(0)))throw Error("user do not has new stake amount");let h=Ct(t,a).publicKey,b=Dt(t,a).publicKey,{publicKey:T,nonce:k}=Et(n,u,s),v=Ee(T,h,c).publicKey,{publicKey:B,nonce:_}=_t(n,u,s),le=Wt(r,i,o,s).publicKey,Y=[],ge=Ee(s,h,c).publicKey;if(await e.getAccountInfo(ge)===null&&Y.push(Vi(s,ge,s,h)),await e.getAccountInfo(T)===null){let Se=_i(r,i,s,o,s,le);Y.push(Se,Wi(n,u,T,B,s,s,k,_))}let{index:xe,isInit:$}=await Ft(e,u,T,h);return $||Y.push(Mi(n,u,T,v,s,s,h,xe,0,void 0,0,!1)),Y.push(Ci(n,u,T,v,ge,s,l,a,h,b,t,xe,m),Di(n,u,T,B)),Y}async function Cl({connection:e,programId:t,governanceProgramId:r,voteWeightAddinProgramId:n,realm:i,communityTokenMint:o,owner:s,poolId:a,tokenProgram:c}){let u=vt(n,i,o).publicKey,l=ie({programId:t,poolId:a,owner:s,version:3}),d=await e.getAccountInfo(l);if(d===null)throw Error("user is not staker");let f=Ve.decode(d.data);if(f.voteLockedBalance.eq(new it(0)))throw Error("user has vote locked balance = 0");let m=Ct(t,a).publicKey,h=Dt(t,a).publicKey,{publicKey:b}=Et(n,u,s),T=Ee(b,m,c).publicKey,{publicKey:k}=_t(n,u,s),v=Wt(r,i,o,s).publicKey,B=[],{index:_,isInit:le}=await Ft(e,u,b,m);if(!le)throw Error("deposit entry index check error");return B.push(Ei(n,u,b,s,v,k,T,Ee(s,m,c).publicKey,l,a,m,h,t,_,f.voteLockedBalance)),B}function Dl({payer:e,rewardVault:t,userRewardTokenPub:r,farmKeys:n,rewardInfo:i}){let o=Buffer.alloc(pt.span);pt.encode({instruction:3,rewardReopenTime:R(i.openTime),rewardEndTime:R(i.endTime),rewardPerSecond:R(i.perSecond)},o);let s=[p({pubkey:te,isWritable:!1}),p({pubkey:n.id}),p({pubkey:n.lpVault,isWritable:!1}),p({pubkey:t}),p({pubkey:r}),p({pubkey:e,isWritable:!1,isSigner:!0})];return new O({programId:n.programId,keys:s,data:o})}function El({payer:e,userRewardTokenPub:t,farmKeys:r,rewardVault:n,rewardInfo:i}){let o=Buffer.alloc(mt.span);mt.encode({instruction:4,isSet:new it(1),rewardPerSecond:R(i.perSecond),rewardOpenTime:R(i.openTime),rewardEndTime:R(i.endTime),rewardType:R(Le[i.rewardType])},o);let s=[...Tt,p({pubkey:r.id}),p({pubkey:r.authority,isWritable:!1}),p({pubkey:i.mint,isWritable:!1}),p({pubkey:n}),p({pubkey:t}),p({pubkey:e,isWritable:!1,isSigner:!0})];return new O({programId:r.programId,keys:s,data:o})}function _l(e){let{farmInfo:t,farmKeys:r,version:n,lpAccount:i,rewardAccounts:o,owner:s,instruction:a,amount:c,deposit:u}=e,[l,d]=[new S(t.programId),new S(t.id)],f=ie({programId:l,poolId:d,owner:s,version:n}),m=Buffer.alloc(H.span);H.encode({instruction:a,amount:c},m);let h=n===6?[p({pubkey:te,isWritable:!1}),...u?[p({pubkey:Pe.programId,isWritable:!1})]:[],p({pubkey:d}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:new S(r.lpVault)}),p({pubkey:f}),p({pubkey:s,isWritable:!1,isSigner:!0}),p({pubkey:i})]:[p({pubkey:d}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:f}),p({pubkey:s,isWritable:!1,isSigner:!0}),p({pubkey:i}),p({pubkey:new S(r.lpVault)}),p({pubkey:o[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:We,isWritable:!1}),p({pubkey:te,isWritable:!1})];if(n===5)for(let b=1;b<r.rewardInfos.length;b++)h.push(p({pubkey:o[b]})),h.push(p({pubkey:new S(r.rewardInfos[b].vault)}));if(n===6)for(let b=0;b<r.rewardInfos.length;b++)h.push(p({pubkey:new S(r.rewardInfos[b].vault)})),h.push(p({pubkey:o[b]}));return new O({programId:l,keys:h,data:m})}function Wl(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s}=e,[a,c]=[new S(t.programId),new S(t.id)],u=ie({programId:a,poolId:c,owner:o,version:6}),l=Buffer.alloc(H.span);H.encode({instruction:2,amount:R(s)},l);let d=[p({pubkey:te,isWritable:!1}),p({pubkey:c}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:new S(r.lpVault)}),p({pubkey:u}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(p({pubkey:new S(r.rewardInfos[f].vault)})),d.push(p({pubkey:i[f]}));return new O({programId:a,keys:d,data:l})}function Ml(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=ie({programId:c,poolId:u,owner:o,version:5}),d=Buffer.alloc(H.span);H.encode({instruction:12,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:We,isWritable:!1}),p({pubkey:te,isWritable:!1})];for(let m=1;m<r.rewardInfos.length;m++)f.push(p({pubkey:i[m]})),f.push(p({pubkey:new S(r.rewardInfos[m].vault)}));if(a)for(let m of a)f.push(p({pubkey:m}));return new O({programId:c,keys:f,data:d})}function Ol(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=ie({programId:c,poolId:u,owner:o,version:3}),d=Buffer.alloc(H.span);H.encode({instruction:11,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:We,isWritable:!1}),p({pubkey:te,isWritable:!1})];if(a)for(let m of a)f.push(p({pubkey:m}));return new O({programId:c,keys:f,data:d})}function Ul(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=ie({programId:c,poolId:u,owner:o,version:3}),d=Buffer.alloc(H.span);H.encode({instruction:10,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:We,isWritable:!1}),p({pubkey:te,isWritable:!1})];if(a)for(let m of a)f.push(p({pubkey:m}));return new O({programId:c,keys:f,data:d})}function ql(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new S(t.programId),new S(t.id)],l=ie({programId:c,poolId:u,owner:o,version:5}),d=Buffer.alloc(H.span);H.encode({instruction:11,amount:R(s)},d);let f=[p({pubkey:u}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:l}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n}),p({pubkey:new S(r.lpVault)}),p({pubkey:i[0]}),p({pubkey:new S(r.rewardInfos[0].vault)}),p({pubkey:We,isWritable:!1}),p({pubkey:te,isWritable:!1})];for(let m=1;m<r.rewardInfos.length;m++)f.push(p({pubkey:i[m]})),f.push(p({pubkey:new S(r.rewardInfos[m].vault)}));if(a)for(let m of a)f.push(p({pubkey:m}));return new O({programId:c,keys:f,data:d})}function Gl(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:i,owner:o,amount:s}=e,[a,c]=[new S(t.programId),new S(t.id)],u=ie({programId:a,poolId:c,owner:o,version:6}),l=Buffer.alloc(H.span);H.encode({instruction:1,amount:R(s)},l);let d=[p({pubkey:te,isWritable:!1}),p({pubkey:Pe.programId,isWritable:!1}),p({pubkey:c}),p({pubkey:new S(r.authority),isWritable:!1}),p({pubkey:new S(r.lpVault)}),p({pubkey:u}),p({pubkey:o,isWritable:!1,isSigner:!0}),p({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(p({pubkey:new S(r.rewardInfos[f].vault)})),d.push(p({pubkey:i[f]}));return new O({programId:a,keys:d,data:l})}export{fs as FARM_LOCK_MINT,ps as FARM_LOCK_VAULT,ys as FARM_PROGRAM_TO_VERSION,rr as FARM_VERSION_TO_LEDGER_LAYOUT,tr as FARM_VERSION_TO_STATE_LAYOUT,cr as Voter,cn as VoterDepositEntry,un as VoterLockup,ur as VoterRegistrar,an as VoterVotingMintConfig,lt as associatedLedgerAccountLayout,ll as calFarmRewardAmount,Kl as createAssociatedLedgerAccountInstruction,H as dwLayout,mt as farmAddRewardLayout,Ss as farmLedgerLayoutV3_1,Ve as farmLedgerLayoutV3_2,ks as farmLedgerLayoutV5_1,sr as farmLedgerLayoutV5_2,ar as farmLedgerLayoutV6_1,cl as farmRewardInfoToConfig,ft as farmRewardLayout,pt as farmRewardRestartLayout,sn as farmRewardTimeInfoLayout,nr as farmStateV3Layout,ir as farmStateV5Layout,or as farmStateV6Layout,dl as fetchMultipleFarmInfoAndUpdate,ul as getAssociatedAuthority,ie as getAssociatedLedgerAccount,al as getAssociatedLedgerPoolAccount,Ft as getDepositEntryIndex,Bi as getFarmLedgerLayout,Ri as getFarmStateLayout,vt as getRegistrarAddress,Wt as getTokenOwnerRecordAddress,Et as getVoterAddress,_t as getVoterWeightRecordAddress,Dt as getVotingMintAuthority,Ct as getVotingTokenMint,_i as governanceCreateTokenOwnerRecord,ms as isValidFarmVersion,fl as judgeFarmType,El as makeAddNewRewardInstruction,Vl as makeCreateFarmInstruction,Fl as makeCreatorWithdrawFarmRewardInstruction,Ul as makeDepositInstructionV3,ql as makeDepositInstructionV5,Gl as makeDepositInstructionV6,vl as makeDepositTokenInstruction,_l as makeDepositWithdrawInstruction,Dl as makeRestartRewardInstruction,Ol as makeWithdrawInstructionV3,Ml as makeWithdrawInstructionV5,Wl as makeWithdrawInstructionV6,Cl as makeWithdrawTokenInstruction,Le as poolTypeV6,rn as realFarmStateV3Layout,nn as realFarmStateV5Layout,on as realFarmV6Layout,Ni as updateFarmPoolInfo,gs as validateFarmRewards,Mi as voterStakeRegistryCreateDepositEntry,Wi as voterStakeRegistryCreateVoter,Ci as voterStakeRegistryDeposit,Di as voterStakeRegistryUpdateVoterWeightRecord,Ei as voterStakeRegistryWithdraw,dt as withdrawRewardLayout};
//# sourceMappingURL=index.mjs.map